{"version":3,"sources":["assets\\Script\\Character\\HitCombos.js"],"names":["require","EnStickState","EnStickMode","AnimNameStick","GameInfo","cc","Class","Component","properties","AttackBox","Node","IsOnAttackCombo","get","_isOnAttackCombo","onLoad","_maxTimeDelayCombos","_maxAttackCombos","_noOfClicks","_lastClickedTime","Date","_rigidBody","node","getComponent","RigidBody","_skeleton","getComponentInChildren","sp","Skeleton","start","onStartAnimation","animationName","StickMode","Archer","NormalJab1","activeAttackBox","NormalKick1","NormalKick2","SwordAtk1","SwordAtk2","SwordAtk3","delayTime","scheduleOnce","active","onCompleteAnimation","cancelAttack","speedUpAnim","setAnimation","onClick","callFirstSkill","Sword","resetSpeedAnim","linearVelocity","x","StickState","Run","SwordRun","NormalRun","Idle","SwordIdle","NormalIdle","timeScale"],"mappings":"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","sourceRoot":"/","sourcesContent":["const { EnStickState, EnStickMode } = require(\"GameEnum\");\r\nvar AnimNameStick = require(\"AnimNameStick\");\r\nvar GameInfo = require(\"GameInfo\");\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        AttackBox: cc.Node,\r\n        IsOnAttackCombo: {\r\n            get() {return this._isOnAttackCombo;}\r\n        }\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this._maxTimeDelayCombos = 1;\r\n        this._maxAttackCombos = 3;\r\n        this._noOfClicks = 0;\r\n        this._isOnAttackCombo = false;\r\n        this._lastClickedTime = new Date();\r\n\r\n        this._rigidBody = this.node.getComponent(cc.RigidBody);\r\n        this._skeleton = this.getComponentInChildren(sp.Skeleton);\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n\r\n    onStartAnimation(animationName){\r\n        if(GameInfo.StickMode == EnStickMode.Archer) return;\r\n        // cc.log(\"animation name start \", animationName, this._noOfClicks);\r\n        \r\n        if(animationName == AnimNameStick.NormalJab1){\r\n            this.activeAttackBox(0.15);\r\n        } else if(animationName == AnimNameStick.NormalKick1){\r\n            this.activeAttackBox(0.15);\r\n        } else if(animationName == AnimNameStick.NormalKick2){\r\n            this.activeAttackBox(0.15);\r\n        }\r\n        // Check animation name sword\r\n        else if(animationName == AnimNameStick.SwordAtk1){\r\n            this.activeAttackBox(0.15);\r\n        } else if(animationName == AnimNameStick.SwordAtk2){\r\n            this.activeAttackBox(0.15);\r\n        } else if(animationName == AnimNameStick.SwordAtk3){\r\n            this.activeAttackBox(0.15);\r\n        }\r\n    },\r\n\r\n    activeAttackBox(delayTime){\r\n        this.scheduleOnce(function() {\r\n            this.AttackBox.active = true;\r\n        }, delayTime);\r\n    },\r\n\r\n    onCompleteAnimation(animationName){\r\n        if(GameInfo.StickMode == EnStickMode.Archer) return;\r\n\r\n        // cc.log(\"animation name end \", animationName, this._noOfClicks);\r\n        if(animationName == AnimNameStick.NormalJab1){\r\n            if(this._noOfClicks <= 1){\r\n               this.cancelAttack();\r\n            } else {\r\n                this.speedUpAnim();\r\n                // cc.log(\"Run Attack 2 Normal Kick\");\r\n                this._skeleton.setAnimation(0, AnimNameStick.NormalKick1, false);\r\n            }\r\n        } else if(animationName == AnimNameStick.NormalKick1){\r\n            if(this._noOfClicks <= 2){\r\n                this.cancelAttack();\r\n             } else {\r\n                this.speedUpAnim();\r\n                this._skeleton.setAnimation(0, AnimNameStick.NormalKick2, false);\r\n             }\r\n        } else if(animationName == AnimNameStick.NormalKick2){\r\n            this.cancelAttack();\r\n        }\r\n        // Check animation name sword\r\n        else if(animationName == AnimNameStick.SwordAtk1){\r\n            if(this._noOfClicks <= 1){\r\n                this.cancelAttack();\r\n             } else {\r\n                this.speedUpAnim();\r\n                this._skeleton.setAnimation(0, AnimNameStick.SwordAtk2, false);\r\n             }\r\n        } else if(animationName == AnimNameStick.SwordAtk2){\r\n            if(this._noOfClicks <= 2){\r\n                this.cancelAttack();\r\n             } else {\r\n                this.speedUpAnim();\r\n                this._skeleton.setAnimation(0, AnimNameStick.SwordAtk3, false);\r\n             }\r\n        } else if(animationName == AnimNameStick.SwordAtk3){\r\n            this.cancelAttack();\r\n        }\r\n    },\r\n\r\n    onClick(){\r\n        if(GameInfo.StickMode == EnStickMode.Archer) return;\r\n\r\n        this._lastClickedTime = new Date();\r\n        this._noOfClicks += 1;\r\n\r\n        if(this._noOfClicks == 1){\r\n            this.callFirstSkill();\r\n        }\r\n\r\n        if(this._noOfClicks > this._maxAttackCombos) this._noOfClicks = this._maxAttackCombos;\r\n        this._isOnAttackCombo = true;\r\n\r\n        // cc.log(\"On Click No Of Click \", this._noOfClicks);\r\n    },\r\n\r\n    callFirstSkill(){\r\n        // console.log(\"Call First Skill\");\r\n        if(GameInfo.StickMode == EnStickMode.Sword){\r\n            this._skeleton.setAnimation(0, AnimNameStick.SwordAtk1, false);\r\n            this.speedUpAnim();\r\n        } else {\r\n            this._skeleton.setAnimation(0, AnimNameStick.NormalJab1, false);\r\n            this.speedUpAnim();\r\n        }\r\n    },\r\n\r\n    cancelAttack(){\r\n        this.resetSpeedAnim();\r\n\r\n        this._isOnAttackCombo = false;\r\n        this._noOfClicks = 0;\r\n\r\n        let linearVelocity = this._rigidBody.linearVelocity;\r\n        if (linearVelocity.x > 0.01 || linearVelocity.x < -0.01){\r\n            GameInfo.StickState = EnStickState.Run;\r\n            if(GameInfo.StickMode == EnStickMode.Sword){\r\n                this._skeleton.setAnimation(0, AnimNameStick.SwordRun, false);\r\n            } else {\r\n                this._skeleton.setAnimation(0, AnimNameStick.NormalRun, true);\r\n            }\r\n        } else {\r\n            GameInfo.StickState = EnStickState.Idle;\r\n            if(GameInfo.StickMode == EnStickMode.Sword){\r\n                this._skeleton.setAnimation(0, AnimNameStick.SwordIdle, false);\r\n            } else {\r\n                this._skeleton.setAnimation(0, AnimNameStick.NormalIdle, true);\r\n            }\r\n        }\r\n    },\r\n\r\n    speedUpAnim(){\r\n        this._skeleton.timeScale = 1.5;\r\n    },\r\n\r\n    resetSpeedAnim(){\r\n        this._skeleton.timeScale = 1;\r\n    }\r\n});\r\n"]}