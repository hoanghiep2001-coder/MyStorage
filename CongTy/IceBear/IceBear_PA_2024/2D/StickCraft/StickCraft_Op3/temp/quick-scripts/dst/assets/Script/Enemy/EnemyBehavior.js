
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/Script/Enemy/EnemyBehavior.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'b2357ctsWpNgY0wztQs7dLX', 'EnemyBehavior');
// Script/Enemy/EnemyBehavior.js

"use strict";

var _require = require("GameEnum"),
    EnStickMode = _require.EnStickMode,
    EnFacing = _require.EnFacing,
    EnEnemies = _require.EnEnemies,
    EnEnemyState = _require.EnEnemyState;

var DetectPlayer = require("DetectPlayer");

var Player3D = require("Player3D");

var EnemyBullet = require("EnemyBullet");

var HealthBarEnemy = require("HealthBarEnemy");

var GameController = require("GameController");

var GameInfo = require("GameInfo");

var CONST = require("CONST");

cc.Class({
  "extends": cc.Component,
  properties: {
    Player: Player3D,
    HealthBar: HealthBarEnemy,
    EnemyId: {
      "default": EnEnemies.None,
      type: EnEnemies
    },
    Speed: {
      "default": 2,
      type: cc.Float
    },
    NodePointA: {
      "default": null,
      type: cc.Node,
      serializable: true
    },
    NodePointB: {
      "default": null,
      type: cc.Node,
      serializable: true
    },
    Facing: {
      "default": EnFacing.Left,
      type: EnFacing
    },
    CollistionDetectPlayer: DetectPlayer,
    MaxHeath: 100,
    BaseAttack: 10,
    FrequenceAttack: 2,
    PrefabBullet: cc.Prefab,
    NodeBarrel: cc.Node,
    CollisionAttack: cc.Node,
    // Particle Effect
    BloodParticle: cc.ParticleSystem3D
  },
  onLoad: function onLoad() {
    var _this = this;

    if (this.NodePointA != null) {
      this._pointA = this.node.convertToWorldSpaceAR(this.NodePointA.getPosition()).x;
      this.NodePointA.active = false;
    } else {
      this._pointA = 0;
    }

    if (this.NodePointB != null) {
      this._pointB = this.node.convertToWorldSpaceAR(this.NodePointB.getPosition()).x;
      this.NodePointB.active = false;
    } else {
      this._pointB = 0;
    } // console.log("Log Move Two Point: " + this._pointA + " " + this._pointB);
    // Get Component Animator


    this._skeleton = this.getComponentInChildren(sp.Skeleton);
    this._stopMove = false;
    this._isDetectPlayer = false;
    this._tick = 0;
    this._waitFrequencyAttack = false;
    this.Speed = CONST.ZombieSpeed;
    this.FrequenceAttack = CONST.ZombieFrequenceAttack;
    if (this.EnemyId == EnEnemies.Zombie) this.HealthBar.init(CONST.ZombieMaxHP);else this.HealthBar.init(CONST.PoisonVineMaxHP);

    this._skeleton.setStartListener(function (trackEntry) {
      var animationName = trackEntry.animation ? trackEntry.animation.name : "";

      _this.onStartAnimation(animationName);
    });

    this._skeleton.setCompleteListener(function (trackEntry) {
      var animationName = trackEntry.animation ? trackEntry.animation.name : "";

      _this.onCompleteAnimation(animationName);
    });
  },
  onStartAnimation: function onStartAnimation(animationName) {
    if (animationName == "atk") {}
  },
  onCompleteAnimation: function onCompleteAnimation(animationName) {
    if (animationName == "atk") {
      this.endAttack();
    }
  },
  start: function start() {
    if (this.Speed > 0 && !GameInfo.GamePause) {
      this._skeleton.setAnimation(0, "walk", true);

      this._currentState = EnEnemyState.Walk;
      this._state = EnEnemyState.Walk;
    } else {
      this._skeleton.setAnimation(0, "idle", true);

      this._currentState = EnEnemyState.Idle;
      this._state = EnEnemyState.Idle;
    }
  },
  update: function update(dt) {
    if (GameInfo.GamePause) {
      this._state = EnEnemyState.Idle;
      this.updateAnimationState();
      return;
    }

    this.moveBettweenTwoPoint(dt);
    this.detectPlayer(dt);
    this.calculateDistancePlayer();
    this.updateAnimationState();
  },
  updateAnimationState: function updateAnimationState() {
    if (this._currentState != this._state) {
      if (this._state == EnEnemyState.Walk) {
        this._skeleton.setAnimation(0, "walk", true);
      } else if (this._state == EnEnemyState.Idle) {
        this._skeleton.setAnimation(0, "idle", true);
      }

      this._currentState = this._state;
    }
  },
  moveBettweenTwoPoint: function moveBettweenTwoPoint(dt) {
    if (GameInfo.GamePause) return;
    if (this.Speed <= 0 || this._stopMove) return;
    if (this.Facing == EnFacing.Right) this.newPosX = this.node.getPosition().x + 1 * this.Speed * 10 * dt;else this.newPosX = this.node.getPosition().x + -1 * this.Speed * 10 * dt;
    this.node.setPosition(this.newPosX, this.node.getPosition().y);

    if (this.node.getPosition().x >= this._pointB && this.Facing == EnFacing.Right || this.node.getPosition().x <= this._pointA && this.Facing == EnFacing.Left) {
      this.flip();
    }

    this._state = EnEnemyState.Walk;
  },
  flip: function flip() {
    if (this.Facing == EnFacing.Left) {
      this.Facing = EnFacing.Right;
      this.node.scale = cc.v2(-1, 1);
    } else {
      this.Facing = EnFacing.Left;
      this.node.scale = cc.v2(1, 1);
    }
  },
  detectPlayer: function detectPlayer(dt) {
    if (this.CollistionDetectPlayer.IsDetectPlayer && !this._isDetectPlayer) {
      this._isDetectPlayer = true;
      this._stopMove = true;
      this.actionWhenDetectPlayer();
    }

    if (!this.CollistionDetectPlayer.IsDetectPlayer && this._isDetectPlayer) {
      this._isDetectPlayer = false;
      this._stopMove = false;
      if (this.Speed > 0) this._state = EnEnemyState.Walk;else this._state = EnEnemyState.Idle;
    }

    if (this._isDetectPlayer) {
      if (!this._waitFrequencyAttack) {
        this.actionWhenDetectPlayer();
      } else {}
    }
  },
  actionWhenDetectPlayer: function actionWhenDetectPlayer() {
    // console.log("Call Attack ==>", this._waitFrequencyAttack);
    if (this._waitFrequencyAttack) return;
    this._waitFrequencyAttack = true;
    this.faceToPlayer();

    this._skeleton.setAnimation(0, "atk", false);

    if (this.EnemyId == EnEnemies.Zombie) {
      this.meleeAttack();
    } else if (this.EnemyId == EnEnemies.PoisonVine) {
      this.archerAttack();
    }

    this.scheduleOnce(function () {
      this._waitFrequencyAttack = false;
    }, this.FrequenceAttack);
  },
  faceToPlayer: function faceToPlayer() {
    if (!this.isFacingWithPlayer()) {
      this.flip();
    }
  },
  isFacingWithPlayer: function isFacingWithPlayer() {
    if (this.Player.node.getPosition().x < this.node.getPosition().x && this.Facing == EnFacing.Right || this.Player.node.getPosition().x > this.node.getPosition().x && this.Facing == EnFacing.Left) {
      return false;
    }

    return true;
  },
  meleeAttack: function meleeAttack() {
    // console.log("Melee Attack");
    this.scheduleOnce(function () {
      this.CollisionAttack.active = true;
    }, 0.3);
  },
  archerAttack: function archerAttack() {
    // console.log("Archer Attack");
    this.scheduleOnce(function () {
      if (!this.HealthBar.isAlive()) return;
      this.createBullet();
    }, 0.3);
  },
  createBullet: function createBullet() {
    var bullet = cc.instantiate(this.PrefabBullet);
    this.node.parent.addChild(bullet);
    bullet.position = this.node.convertToWorldSpaceAR(this.NodeBarrel.getPosition());
    var bulletLogic = bullet.getComponent(EnemyBullet);
    var dir = 1;
    if (this.Facing == EnFacing.Left) dir = -1;
    bulletLogic.Launch(this.BaseAttack, dir); // console.log("Create Bullet: " + bullet.getPosition());
  },
  isPlayerFacing: function isPlayerFacing() {
    if (this.Player.node.x < this.node.x && this.Player.node.scaleX > 0 || this.Player.node.x > this.node.x && this.Player.node.scaleX < 0) {
      return true;
    }

    return false;
  },
  calculateDistancePlayer: function calculateDistancePlayer() {
    if (!this.HealthBar.isAlive()) return;
    if (GameInfo.StickMode != EnStickMode.Archer) return;
    if (!this.isPlayerFacing()) return;
    var distance = Math.abs(this.node.x - this.Player.node.x);

    if (distance < CONST.MaxDistanceEnemyArcher) {
      this.Player.checkNearestEnemy(this.node, distance);
    } else {
      this.Player.removeNearestEnemy(this.node);
    }
  },
  hit: function hit() {
    if (!this.HealthBar.isAlive()) return;
    var damp = CONST.StickBaseAttack;
    this.HealthBar.decrement(damp);
    this.BloodParticle.play();
    if (!GameInfo.TutorialDoneStage1) GameInfo.TutorialDoneStage1 = true;else if (GameInfo.TutorialStartStage2 && !GameInfo.TutorialDoneStage2) GameInfo.TutorialDoneStage2 = true;

    if (!this.HealthBar.isAlive()) {
      this.die();
    }
  },
  die: function die() {
    this.effectDie();
    this.scheduleOnce(function () {
      GameInfo.TotalEnemyAlive -= 1;
      this.node.destroy();
    }, 1);
    this.Player.removeNearestEnemy(this.node);
  },
  effectDie: function effectDie() {
    this.HealthBar.node.active = false;
    var rd = this.node.getComponent(cc.RigidBody);
    rd.type = cc.RigidBodyType.Dynamic;
    rd.gravityScale = 0.1;
    rd.fixedRotation = false;
    cc.tween(this.node).to(0.5, {
      angle: 90 * this.getSidePlayer()
    }).start();
    rd.applyForceToCenter(cc.v2((Math.random() * 30 + 120) * 250 * this.getSidePlayer(), (Math.random() * 20 + 50) * 250), true);
  },
  getSidePlayer: function getSidePlayer() {
    if (this.Player.node.x > this.node.x) return -1;
    return 1;
  },
  onCollisionEnter: function onCollisionEnter(other, self) {
    if (other.node.group == "BoxPlayer") {
      this.hit();
    }
  },
  endAttack: function endAttack() {
    if (this.Speed <= 0 || this._stopMove) {
      this._state = EnEnemyState.Idle;

      this._skeleton.setAnimation(0, "idle", true);
    } else {
      this._state = EnEnemyState.Walk;

      this._skeleton.setAnimation(0, "walk", true);
    }
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcU2NyaXB0XFxFbmVteVxcRW5lbXlCZWhhdmlvci5qcyJdLCJuYW1lcyI6WyJyZXF1aXJlIiwiRW5TdGlja01vZGUiLCJFbkZhY2luZyIsIkVuRW5lbWllcyIsIkVuRW5lbXlTdGF0ZSIsIkRldGVjdFBsYXllciIsIlBsYXllcjNEIiwiRW5lbXlCdWxsZXQiLCJIZWFsdGhCYXJFbmVteSIsIkdhbWVDb250cm9sbGVyIiwiR2FtZUluZm8iLCJDT05TVCIsImNjIiwiQ2xhc3MiLCJDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwiUGxheWVyIiwiSGVhbHRoQmFyIiwiRW5lbXlJZCIsIk5vbmUiLCJ0eXBlIiwiU3BlZWQiLCJGbG9hdCIsIk5vZGVQb2ludEEiLCJOb2RlIiwic2VyaWFsaXphYmxlIiwiTm9kZVBvaW50QiIsIkZhY2luZyIsIkxlZnQiLCJDb2xsaXN0aW9uRGV0ZWN0UGxheWVyIiwiTWF4SGVhdGgiLCJCYXNlQXR0YWNrIiwiRnJlcXVlbmNlQXR0YWNrIiwiUHJlZmFiQnVsbGV0IiwiUHJlZmFiIiwiTm9kZUJhcnJlbCIsIkNvbGxpc2lvbkF0dGFjayIsIkJsb29kUGFydGljbGUiLCJQYXJ0aWNsZVN5c3RlbTNEIiwib25Mb2FkIiwiX3BvaW50QSIsIm5vZGUiLCJjb252ZXJ0VG9Xb3JsZFNwYWNlQVIiLCJnZXRQb3NpdGlvbiIsIngiLCJhY3RpdmUiLCJfcG9pbnRCIiwiX3NrZWxldG9uIiwiZ2V0Q29tcG9uZW50SW5DaGlsZHJlbiIsInNwIiwiU2tlbGV0b24iLCJfc3RvcE1vdmUiLCJfaXNEZXRlY3RQbGF5ZXIiLCJfdGljayIsIl93YWl0RnJlcXVlbmN5QXR0YWNrIiwiWm9tYmllU3BlZWQiLCJab21iaWVGcmVxdWVuY2VBdHRhY2siLCJab21iaWUiLCJpbml0IiwiWm9tYmllTWF4SFAiLCJQb2lzb25WaW5lTWF4SFAiLCJzZXRTdGFydExpc3RlbmVyIiwidHJhY2tFbnRyeSIsImFuaW1hdGlvbk5hbWUiLCJhbmltYXRpb24iLCJuYW1lIiwib25TdGFydEFuaW1hdGlvbiIsInNldENvbXBsZXRlTGlzdGVuZXIiLCJvbkNvbXBsZXRlQW5pbWF0aW9uIiwiZW5kQXR0YWNrIiwic3RhcnQiLCJHYW1lUGF1c2UiLCJzZXRBbmltYXRpb24iLCJfY3VycmVudFN0YXRlIiwiV2FsayIsIl9zdGF0ZSIsIklkbGUiLCJ1cGRhdGUiLCJkdCIsInVwZGF0ZUFuaW1hdGlvblN0YXRlIiwibW92ZUJldHR3ZWVuVHdvUG9pbnQiLCJkZXRlY3RQbGF5ZXIiLCJjYWxjdWxhdGVEaXN0YW5jZVBsYXllciIsIlJpZ2h0IiwibmV3UG9zWCIsInNldFBvc2l0aW9uIiwieSIsImZsaXAiLCJzY2FsZSIsInYyIiwiSXNEZXRlY3RQbGF5ZXIiLCJhY3Rpb25XaGVuRGV0ZWN0UGxheWVyIiwiZmFjZVRvUGxheWVyIiwibWVsZWVBdHRhY2siLCJQb2lzb25WaW5lIiwiYXJjaGVyQXR0YWNrIiwic2NoZWR1bGVPbmNlIiwiaXNGYWNpbmdXaXRoUGxheWVyIiwiaXNBbGl2ZSIsImNyZWF0ZUJ1bGxldCIsImJ1bGxldCIsImluc3RhbnRpYXRlIiwicGFyZW50IiwiYWRkQ2hpbGQiLCJwb3NpdGlvbiIsImJ1bGxldExvZ2ljIiwiZ2V0Q29tcG9uZW50IiwiZGlyIiwiTGF1bmNoIiwiaXNQbGF5ZXJGYWNpbmciLCJzY2FsZVgiLCJTdGlja01vZGUiLCJBcmNoZXIiLCJkaXN0YW5jZSIsIk1hdGgiLCJhYnMiLCJNYXhEaXN0YW5jZUVuZW15QXJjaGVyIiwiY2hlY2tOZWFyZXN0RW5lbXkiLCJyZW1vdmVOZWFyZXN0RW5lbXkiLCJoaXQiLCJkYW1wIiwiU3RpY2tCYXNlQXR0YWNrIiwiZGVjcmVtZW50IiwicGxheSIsIlR1dG9yaWFsRG9uZVN0YWdlMSIsIlR1dG9yaWFsU3RhcnRTdGFnZTIiLCJUdXRvcmlhbERvbmVTdGFnZTIiLCJkaWUiLCJlZmZlY3REaWUiLCJUb3RhbEVuZW15QWxpdmUiLCJkZXN0cm95IiwicmQiLCJSaWdpZEJvZHkiLCJSaWdpZEJvZHlUeXBlIiwiRHluYW1pYyIsImdyYXZpdHlTY2FsZSIsImZpeGVkUm90YXRpb24iLCJ0d2VlbiIsInRvIiwiYW5nbGUiLCJnZXRTaWRlUGxheWVyIiwiYXBwbHlGb3JjZVRvQ2VudGVyIiwicmFuZG9tIiwib25Db2xsaXNpb25FbnRlciIsIm90aGVyIiwic2VsZiIsImdyb3VwIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLGVBQTBEQSxPQUFPLENBQUMsVUFBRCxDQUFqRTtBQUFBLElBQVFDLFdBQVIsWUFBUUEsV0FBUjtBQUFBLElBQXFCQyxRQUFyQixZQUFxQkEsUUFBckI7QUFBQSxJQUErQkMsU0FBL0IsWUFBK0JBLFNBQS9CO0FBQUEsSUFBMENDLFlBQTFDLFlBQTBDQSxZQUExQzs7QUFDQSxJQUFJQyxZQUFZLEdBQUdMLE9BQU8sQ0FBQyxjQUFELENBQTFCOztBQUNBLElBQUlNLFFBQVEsR0FBR04sT0FBTyxDQUFDLFVBQUQsQ0FBdEI7O0FBQ0EsSUFBSU8sV0FBVyxHQUFHUCxPQUFPLENBQUMsYUFBRCxDQUF6Qjs7QUFDQSxJQUFJUSxjQUFjLEdBQUdSLE9BQU8sQ0FBQyxnQkFBRCxDQUE1Qjs7QUFDQSxJQUFJUyxjQUFjLEdBQUdULE9BQU8sQ0FBQyxnQkFBRCxDQUE1Qjs7QUFDQSxJQUFNVSxRQUFRLEdBQUdWLE9BQU8sQ0FBQyxVQUFELENBQXhCOztBQUNBLElBQU1XLEtBQUssR0FBR1gsT0FBTyxDQUFDLE9BQUQsQ0FBckI7O0FBRUFZLEVBQUUsQ0FBQ0MsS0FBSCxDQUFTO0FBQ0wsYUFBU0QsRUFBRSxDQUFDRSxTQURQO0FBR0xDLEVBQUFBLFVBQVUsRUFBRTtBQUNSQyxJQUFBQSxNQUFNLEVBQUVWLFFBREE7QUFFUlcsSUFBQUEsU0FBUyxFQUFFVCxjQUZIO0FBR1JVLElBQUFBLE9BQU8sRUFBRTtBQUNMLGlCQUFTZixTQUFTLENBQUNnQixJQURkO0FBRUxDLE1BQUFBLElBQUksRUFBRWpCO0FBRkQsS0FIRDtBQU9Sa0IsSUFBQUEsS0FBSyxFQUFFO0FBQ0gsaUJBQVMsQ0FETjtB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S0FBSyxDQUFDdkcsSUFBTixDQUFXeUcsS0FBWCxJQUFvQixXQUF2QixFQUFtQztBQUMvQixXQUFLM0IsR0FBTDtBQUNIO0FBQ0osR0E3VUk7QUErVUxsRCxFQUFBQSxTQS9VSyx1QkErVU07QUFDUCxRQUFHLEtBQUtoRCxLQUFMLElBQWMsQ0FBZCxJQUFtQixLQUFLOEIsU0FBM0IsRUFBcUM7QUFDakMsV0FBS3dCLE1BQUwsR0FBY3ZFLFlBQVksQ0FBQ3dFLElBQTNCOztBQUNBLFdBQUs3QixTQUFMLENBQWV5QixZQUFmLENBQTRCLENBQTVCLEVBQStCLE1BQS9CLEVBQXVDLElBQXZDO0FBQ0gsS0FIRCxNQUdPO0FBQ0gsV0FBS0csTUFBTCxHQUFjdkUsWUFBWSxDQUFDc0UsSUFBM0I7O0FBQ0EsV0FBSzNCLFNBQUwsQ0FBZXlCLFlBQWYsQ0FBNEIsQ0FBNUIsRUFBK0IsTUFBL0IsRUFBdUMsSUFBdkM7QUFDSDtBQUNKO0FBdlZJLENBQVQiLCJzb3VyY2VSb290IjoiLyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgRW5TdGlja01vZGUsIEVuRmFjaW5nLCBFbkVuZW1pZXMsIEVuRW5lbXlTdGF0ZX0gPSByZXF1aXJlKFwiR2FtZUVudW1cIik7XHJcbnZhciBEZXRlY3RQbGF5ZXIgPSByZXF1aXJlKFwiRGV0ZWN0UGxheWVyXCIpO1xyXG52YXIgUGxheWVyM0QgPSByZXF1aXJlKFwiUGxheWVyM0RcIik7XHJcbnZhciBFbmVteUJ1bGxldCA9IHJlcXVpcmUoXCJFbmVteUJ1bGxldFwiKTtcclxudmFyIEhlYWx0aEJhckVuZW15ID0gcmVxdWlyZShcIkhlYWx0aEJhckVuZW15XCIpO1xyXG52YXIgR2FtZUNvbnRyb2xsZXIgPSByZXF1aXJlKFwiR2FtZUNvbnRyb2xsZXJcIik7XHJcbmNvbnN0IEdhbWVJbmZvID0gcmVxdWlyZShcIkdhbWVJbmZvXCIpO1xyXG5jb25zdCBDT05TVCA9IHJlcXVpcmUoXCJDT05TVFwiKTtcclxuXHJcbmNjLkNsYXNzKHtcclxuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcclxuXHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgICAgUGxheWVyOiBQbGF5ZXIzRCxcclxuICAgICAgICBIZWFsdGhCYXI6IEhlYWx0aEJhckVuZW15LFxyXG4gICAgICAgIEVuZW15SWQ6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogRW5FbmVtaWVzLk5vbmUsXHJcbiAgICAgICAgICAgIHR5cGU6IEVuRW5lbWllc1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgU3BlZWQ6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogMixcclxuICAgICAgICAgICAgdHlwZTogY2MuRmxvYXRcclxuICAgICAgICB9LFxyXG4gICAgICAgIE5vZGVQb2ludEE6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogbnVsbCxcclxuICAgICAgICAgICAgdHlwZTogY2MuTm9kZSxcclxuICAgICAgICAgICAgc2VyaWFsaXphYmxlOiB0cnVlLFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgTm9kZVBvaW50Qjoge1xyXG4gICAgICAgICAgICBkZWZhdWx0OiBudWxsLFxyXG4gICAgICAgICAgICB0eXBlOiBjYy5Ob2RlLFxyXG4gICAgICAgICAgICBzZXJpYWxpemFibGU6IHRydWUsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBGYWNpbmc6IHtcclxuICAgICAgICAgICAgZGVmYXVsdDogRW5GYWNpbmcuTGVmdCxcclxuICAgICAgICAgICAgdHlwZTogRW5GYWNpbmcsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBDb2xsaXN0aW9uRGV0ZWN0UGxheWVyOiBEZXRlY3RQbGF5ZXIsXHJcbiAgICAgICAgTWF4SGVhdGg6IDEwMCxcclxuICAgICAgICBCYXNlQXR0YWNrOiAxMCxcclxuICAgICAgICBGcmVxdWVuY2VBdHRhY2s6IDIsXHJcbiAgICAgICAgUHJlZmFiQnVsbGV0OiBjYy5QcmVmYWIsXHJcbiAgICAgICAgTm9kZUJhcnJlbDogY2MuTm9kZSxcclxuICAgICAgICBDb2xsaXNpb25BdHRhY2s6IGNjLk5vZGUsXHJcblxyXG4gICAgICAgIC8vIFBhcnRpY2xlIEVmZmVjdFxyXG4gICAgICAgIEJsb29kUGFydGljbGU6IGNjLlBhcnRpY2xlU3lzdGVtM0QsXHJcbiAgICB9LFxyXG5cclxuICAgIG9uTG9hZCAoKSB7XHJcbiAgICAgICAgaWYodGhpcy5Ob2RlUG9pbnRBICE9IG51bGwpe1xyXG4gICAgICAgICAgIHRoaXMuX3BvaW50QSA9IHRoaXMubm9kZS5jb252ZXJ0VG9Xb3JsZFNwYWNlQVIodGhpcy5Ob2RlUG9pbnRBLmdldFBvc2l0aW9uKCkpLng7XHJcbiAgICAgICAgICAgdGhpcy5Ob2RlUG9pbnRBLmFjdGl2ZSA9IGZhbHNlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3BvaW50QSA9IDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZih0aGlzLk5vZGVQb2ludEIgIT0gbnVsbCl7XHJcbiAgICAgICAgICAgIHRoaXMuX3BvaW50QiA9IHRoaXMubm9kZS5jb252ZXJ0VG9Xb3JsZFNwYWNlQVIodGhpcy5Ob2RlUG9pbnRCLmdldFBvc2l0aW9uKCkpLng7XHJcbiAgICAgICAgICAgIHRoaXMuTm9kZVBvaW50Qi5hY3RpdmUgPSBmYWxzZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9wb2ludEIgPSAwO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJMb2cgTW92ZSBUd28gUG9pbnQ6IFwiICsgdGhpcy5fcG9pbnRBICsgXCIgXCIgKyB0aGlzLl9wb2ludEIpO1xyXG5cclxuICAgICAgICAvLyBHZXQgQ29tcG9uZW50IEFuaW1hdG9yXHJcbiAgICAgICAgdGhpcy5fc2tlbGV0b24gPSB0aGlzLmdldENvbXBvbmVudEluQ2hpbGRyZW4oc3AuU2tlbGV0b24pO1xyXG5cclxuICAgICAgICB0aGlzLl9zdG9wTW92ZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLl9pc0RldGVjdFBsYXllciA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLl90aWNrID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5fd2FpdEZyZXF1ZW5jeUF0dGFjayA9IGZhbHNlO1xyXG5cclxuICAgICAgICB0aGlzLlNwZWVkID0gQ09OU1QuWm9tYmllU3BlZWQ7XHJcblxyXG4gICAgICAgIHRoaXMuRnJlcXVlbmNlQXR0YWNrID0gQ09OU1QuWm9tYmllRnJlcXVlbmNlQXR0YWNrO1xyXG5cclxuICAgICAgICBpZih0aGlzLkVuZW15SWQgPT0gRW5FbmVtaWVzLlpvbWJpZSkgdGhpcy5IZWFsdGhCYXIuaW5pdChDT05TVC5ab21iaWVNYXhIUCk7XHJcbiAgICAgICAgZWxzZSB0aGlzLkhlYWx0aEJhci5pbml0KENPTlNULlBvaXNvblZpbmVNYXhIUCk7XHJcblxyXG4gICAgICAgIHRoaXMuX3NrZWxldG9uLnNldFN0YXJ0TGlzdGVuZXIodHJhY2tFbnRyeSA9PiB7XHJcbiAgICAgICAgICAgIHZhciBhbmltYXRpb25OYW1lID0gdHJhY2tFbnRyeS5hbmltYXRpb24gPyB0cmFja0VudHJ5LmFuaW1hdGlvbi5uYW1lIDogXCJcIjtcclxuICAgICAgICAgICAgdGhpcy5vblN0YXJ0QW5pbWF0aW9uKGFuaW1hdGlvbk5hbWUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLl9za2VsZXRvbi5zZXRDb21wbGV0ZUxpc3RlbmVyKCh0cmFja0VudHJ5KSA9PiB7XHJcbiAgICAgICAgICAgIHZhciBhbmltYXRpb25OYW1lID0gdHJhY2tFbnRyeS5hbmltYXRpb24gPyB0cmFja0VudHJ5LmFuaW1hdGlvbi5uYW1lIDogXCJcIjtcclxuICAgICAgICAgICAgdGhpcy5vbkNvbXBsZXRlQW5pbWF0aW9uKGFuaW1hdGlvbk5hbWUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICBvblN0YXJ0QW5pbWF0aW9uKGFuaW1hdGlvbk5hbWUpe1xyXG4gICAgICAgIGlmKGFuaW1hdGlvbk5hbWUgPT0gXCJhdGtcIil7XHJcblxyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgb25Db21wbGV0ZUFuaW1hdGlvbihhbmltYXRpb25OYW1lKXtcclxuICAgICAgICBpZihhbmltYXRpb25OYW1lID09IFwiYXRrXCIpe1xyXG4gICAgICAgICAgICB0aGlzLmVuZEF0dGFjaygpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgc3RhcnQgKCkge1xyXG5cclxuICAgICAgICBpZih0aGlzLlNwZWVkID4gMCAmJiAhR2FtZUluZm8uR2FtZVBhdXNlKXtcclxuICAgICAgICAgICAgdGhpcy5fc2tlbGV0b24uc2V0QW5pbWF0aW9uKDAsIFwid2Fsa1wiLCB0cnVlKTtcclxuICAgICAgICAgICAgdGhpcy5fY3VycmVudFN0YXRlID0gRW5FbmVteVN0YXRlLldhbGs7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gRW5FbmVteVN0YXRlLldhbGs7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fc2tlbGV0b24uc2V0QW5pbWF0aW9uKDAsIFwiaWRsZVwiLCB0cnVlKTtcclxuICAgICAgICAgICAgdGhpcy5fY3VycmVudFN0YXRlID0gRW5FbmVteVN0YXRlLklkbGU7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gRW5FbmVteVN0YXRlLklkbGU7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGUgKGR0KSB7XHJcbiAgICAgICAgaWYoR2FtZUluZm8uR2FtZVBhdXNlKXtcclxuICAgICAgICAgICAgdGhpcy5fc3RhdGUgPSBFbkVuZW15U3RhdGUuSWRsZTtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVBbmltYXRpb25TdGF0ZSgpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfSBcclxuXHJcbiAgICAgICAgdGhpcy5tb3ZlQmV0dHdlZW5Ud29Qb2ludChkdCk7XHJcblxyXG4gICAgICAgIHRoaXMuZGV0ZWN0UGxheWVyKGR0KTtcclxuXHJcbiAgICAgICAgdGhpcy5jYWxjdWxhdGVEaXN0YW5jZVBsYXllcigpO1xyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZUFuaW1hdGlvblN0YXRlKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZUFuaW1hdGlvblN0YXRlKCl7XHJcbiAgICAgICAgaWYodGhpcy5fY3VycmVudFN0YXRlICE9IHRoaXMuX3N0YXRlKXtcclxuICAgICAgICAgICAgaWYodGhpcy5fc3RhdGUgPT0gRW5FbmVteVN0YXRlLldhbGspe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2tlbGV0b24uc2V0QW5pbWF0aW9uKDAsIFwid2Fsa1wiLCB0cnVlKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmKHRoaXMuX3N0YXRlID09IEVuRW5lbXlTdGF0ZS5JZGxlKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3NrZWxldG9uLnNldEFuaW1hdGlvbigwLCBcImlkbGVcIiwgdHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRTdGF0ZSA9IHRoaXMuX3N0YXRlO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgbW92ZUJldHR3ZWVuVHdvUG9pbnQgKGR0KSB7XHJcbiAgICAgICAgaWYoR2FtZUluZm8uR2FtZVBhdXNlKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmKHRoaXMuU3BlZWQgPD0gMCB8fCB0aGlzLl9zdG9wTW92ZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5GYWNpbmcgPT0gRW5GYWNpbmcuUmlnaHQpXHJcbiAgICAgICAgICAgIHRoaXMubmV3UG9zWCA9IHRoaXMubm9kZS5nZXRQb3NpdGlvbigpLnggKyAxICogdGhpcy5TcGVlZCAqIDEwICogZHQ7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB0aGlzLm5ld1Bvc1ggPSB0aGlzLm5vZGUuZ2V0UG9zaXRpb24oKS54ICsgLTEgKiB0aGlzLlNwZWVkICogMTAgKiBkdDtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLm5vZGUuc2V0UG9zaXRpb24odGhpcy5uZXdQb3NYLCB0aGlzLm5vZGUuZ2V0UG9zaXRpb24oKS55KTtcclxuXHJcbiAgICAgICAgaWYgKCh0aGlzLm5vZGUuZ2V0UG9zaXRpb24oKS54ID49IHRoaXMuX3BvaW50QiAmJiB0aGlzLkZhY2luZyA9PSBFbkZhY2luZy5SaWdodCB8fFxyXG4gICAgICAgICAgICB0aGlzLm5vZGUuZ2V0UG9zaXRpb24oKS54IDw9IHRoaXMuX3BvaW50QSAmJiB0aGlzLkZhY2luZyA9PSBFbkZhY2luZy5MZWZ0KSl7XHJcbiAgICAgICAgICAgIHRoaXMuZmxpcCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5fc3RhdGUgPSBFbkVuZW15U3RhdGUuV2FsaztcclxuICAgIH0sXHJcblxyXG4gICAgZmxpcCAoKSB7XHJcbiAgICAgICAgaWYodGhpcy5GYWNpbmcgPT0gRW5GYWNpbmcuTGVmdCl7XHJcbiAgICAgICAgICAgIHRoaXMuRmFjaW5nID0gRW5GYWNpbmcuUmlnaHQ7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5zY2FsZSA9IGNjLnYyKC0xLCAxKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLkZhY2luZyA9IEVuRmFjaW5nLkxlZnQ7XHJcbiAgICAgICAgICAgIHRoaXMubm9kZS5zY2FsZSA9IGNjLnYyKDEsIDEpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgZGV0ZWN0UGxheWVyIChkdCkge1xyXG4gICAgICAgIGlmKHRoaXMuQ29sbGlzdGlvbkRldGVjdFBsYXllci5Jc0RldGVjdFBsYXllciAmJiAhdGhpcy5faXNEZXRlY3RQbGF5ZXIpe1xyXG4gICAgICAgICAgICB0aGlzLl9pc0RldGVjdFBsYXllciA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0b3BNb3ZlID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5hY3Rpb25XaGVuRGV0ZWN0UGxheWVyKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZighdGhpcy5Db2xsaXN0aW9uRGV0ZWN0UGxheWVyLklzRGV0ZWN0UGxheWVyICYmIHRoaXMuX2lzRGV0ZWN0UGxheWVyKXtcclxuICAgICAgICAgICAgdGhpcy5faXNEZXRlY3RQbGF5ZXIgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5fc3RvcE1vdmUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIGlmKHRoaXMuU3BlZWQgPiAwKSB0aGlzLl9zdGF0ZSA9IEVuRW5lbXlTdGF0ZS5XYWxrO1xyXG4gICAgICAgICAgICBlbHNlIHRoaXMuX3N0YXRlID0gRW5FbmVteVN0YXRlLklkbGU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZih0aGlzLl9pc0RldGVjdFBsYXllcil7XHJcbiAgICAgICAgICAgIGlmKCF0aGlzLl93YWl0RnJlcXVlbmN5QXR0YWNrKXtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWN0aW9uV2hlbkRldGVjdFBsYXllcigpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIGFjdGlvbldoZW5EZXRlY3RQbGF5ZXIoKXtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcIkNhbGwgQXR0YWNrID09PlwiLCB0aGlzLl93YWl0RnJlcXVlbmN5QXR0YWNrKTtcclxuICAgICAgICBpZih0aGlzLl93YWl0RnJlcXVlbmN5QXR0YWNrKSByZXR1cm47XHJcblxyXG4gICAgICAgIHRoaXMuX3dhaXRGcmVxdWVuY3lBdHRhY2sgPSB0cnVlO1xyXG5cclxuICAgICAgICB0aGlzLmZhY2VUb1BsYXllcigpO1xyXG4gICAgICAgIHRoaXMuX3NrZWxldG9uLnNldEFuaW1hdGlvbigwLCBcImF0a1wiLCBmYWxzZSk7XHJcblxyXG4gICAgICAgIGlmKHRoaXMuRW5lbXlJZCA9PSBFbkVuZW1pZXMuWm9tYmllKXtcclxuICAgICAgICAgICAgdGhpcy5tZWxlZUF0dGFjaygpO1xyXG4gICAgICAgIH0gZWxzZSBpZih0aGlzLkVuZW15SWQgPT0gRW5FbmVtaWVzLlBvaXNvblZpbmUpe1xyXG4gICAgICAgICAgICB0aGlzLmFyY2hlckF0dGFjaygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3dhaXRGcmVxdWVuY3lBdHRhY2sgPSBmYWxzZTtcclxuICAgICAgICB9LCB0aGlzLkZyZXF1ZW5jZUF0dGFjayk7XHJcbiAgICB9LFxyXG5cclxuICAgIGZhY2VUb1BsYXllcigpe1xyXG4gICAgICAgIGlmKCF0aGlzLmlzRmFjaW5nV2l0aFBsYXllcigpKXtcclxuICAgICAgICAgICAgdGhpcy5mbGlwKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBpc0ZhY2luZ1dpdGhQbGF5ZXIoKXtcclxuICAgICAgICBpZih0aGlzLlBsYXllci5ub2RlLmdldFBvc2l0aW9uKCkueCA8IHRoaXMubm9kZS5nZXRQb3NpdGlvbigpLnggJiYgdGhpcy5GYWNpbmcgPT0gRW5GYWNpbmcuUmlnaHRcclxuICAgICAgICB8fCB0aGlzLlBsYXllci5ub2RlLmdldFBvc2l0aW9uKCkueCA+IHRoaXMubm9kZS5nZXRQb3NpdGlvbigpLnggJiYgdGhpcy5GYWNpbmcgPT0gRW5GYWNpbmcuTGVmdCl7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSxcclxuXHJcbiAgICBtZWxlZUF0dGFjaygpe1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKFwiTWVsZWUgQXR0YWNrXCIpO1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLkNvbGxpc2lvbkF0dGFjay5hY3RpdmUgPSB0cnVlO1xyXG4gICAgICAgIH0sIDAuMyk7XHJcbiAgICB9LFxyXG4gICAgXHJcbiAgICBhcmNoZXJBdHRhY2soKXtcclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhcIkFyY2hlciBBdHRhY2tcIik7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZU9uY2UoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmKCF0aGlzLkhlYWx0aEJhci5pc0FsaXZlKCkpIHJldHVybjtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVCdWxsZXQoKTtcclxuICAgICAgICB9LCAwLjMpO1xyXG4gICAgfSxcclxuXHJcbiAgICBjcmVhdGVCdWxsZXQoKXtcclxuICAgICAgICBsZXQgYnVsbGV0ID0gY2MuaW5zdGFudGlhdGUodGhpcy5QcmVmYWJCdWxsZXQpO1xyXG4gICAgICAgIHRoaXMubm9kZS5wYXJlbnQuYWRkQ2hpbGQoYnVsbGV0KTtcclxuXHJcbiAgICAgICAgYnVsbGV0LnBvc2l0aW9uID0gdGhpcy5ub2RlLmNvbnZlcnRUb1dvcmxkU3BhY2VBUih0aGlzLk5vZGVCYXJyZWwuZ2V0UG9zaXRpb24oKSk7XHJcblxyXG4gICAgICAgIGxldCBidWxsZXRMb2dpYyA9IGJ1bGxldC5nZXRDb21wb25lbnQoRW5lbXlCdWxsZXQpO1xyXG5cclxuICAgICAgICBsZXQgZGlyID0gMTtcclxuICAgICAgICBpZih0aGlzLkZhY2luZyA9PSBFbkZhY2luZy5MZWZ0KSBkaXIgPSAtMTtcclxuXHJcbiAgICAgICAgYnVsbGV0TG9naWMuTGF1bmNoKHRoaXMuQmFzZUF0dGFjaywgZGlyKTtcclxuXHJcbiAgICAgICAgLy8gY29uc29sZS5sb2coXCJDcmVhdGUgQnVsbGV0OiBcIiArIGJ1bGxldC5nZXRQb3NpdGlvbigpKTtcclxuICAgIH0sXHJcblxyXG4gICAgaXNQbGF5ZXJGYWNpbmcoKXtcclxuICAgICAgICBpZiAodGhpcy5QbGF5ZXIubm9kZS54IDwgdGhpcy5ub2RlLnggJiYgdGhpcy5QbGF5ZXIubm9kZS5zY2FsZVggPiAwXHJcbiAgICAgICAgICAgIHx8IHRoaXMuUGxheWVyLm5vZGUueCA+IHRoaXMubm9kZS54ICYmIHRoaXMuUGxheWVyLm5vZGUuc2NhbGVYIDwgMCl7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfSxcclxuXHJcbiAgICBjYWxjdWxhdGVEaXN0YW5jZVBsYXllcigpe1xyXG4gICAgICAgIGlmKCF0aGlzLkhlYWx0aEJhci5pc0FsaXZlKCkpIHJldHVybjtcclxuXHJcbiAgICAgICAgaWYoR2FtZUluZm8uU3RpY2tNb2RlICE9IEVuU3RpY2tNb2RlLkFyY2hlcikgcmV0dXJuO1xyXG5cclxuICAgICAgICBpZighdGhpcy5pc1BsYXllckZhY2luZygpKSByZXR1cm47XHJcblxyXG4gICAgICAgIGxldCBkaXN0YW5jZSA9IE1hdGguYWJzKHRoaXMubm9kZS54IC0gdGhpcy5QbGF5ZXIubm9kZS54KTtcclxuXHJcbiAgICAgICAgaWYoZGlzdGFuY2UgPCBDT05TVC5NYXhEaXN0YW5jZUVuZW15QXJjaGVyKXtcclxuICAgICAgICAgICAgdGhpcy5QbGF5ZXIuY2hlY2tOZWFyZXN0RW5lbXkodGhpcy5ub2RlLCBkaXN0YW5jZSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5QbGF5ZXIucmVtb3ZlTmVhcmVzdEVuZW15KHRoaXMubm9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBoaXQoKXtcclxuICAgICAgICBpZighdGhpcy5IZWFsdGhCYXIuaXNBbGl2ZSgpKSByZXR1cm47XHJcblxyXG4gICAgICAgIGxldCBkYW1wID0gQ09OU1QuU3RpY2tCYXNlQXR0YWNrO1xyXG4gICAgICAgIHRoaXMuSGVhbHRoQmFyLmRlY3JlbWVudChkYW1wKTtcclxuXHJcbiAgICAgICAgdGhpcy5CbG9vZFBhcnRpY2xlLnBsYXkoKTtcclxuXHJcbiAgICAgICAgaWYoIUdhbWVJbmZvLlR1dG9yaWFsRG9uZVN0YWdlMSkgR2FtZUluZm8uVHV0b3JpYWxEb25lU3RhZ2UxID0gdHJ1ZTtcclxuICAgICAgICBlbHNlIGlmKEdhbWVJbmZvLlR1dG9yaWFsU3RhcnRTdGFnZTIgJiYgIUdhbWVJbmZvLlR1dG9yaWFsRG9uZVN0YWdlMikgR2FtZUluZm8uVHV0b3JpYWxEb25lU3RhZ2UyID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgaWYoIXRoaXMuSGVhbHRoQmFyLmlzQWxpdmUoKSl7XHJcbiAgICAgICAgICAgIHRoaXMuZGllKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBkaWUoKXtcclxuICAgICAgICB0aGlzLmVmZmVjdERpZSgpO1xyXG4gICAgICAgIHRoaXMuc2NoZWR1bGVPbmNlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBHYW1lSW5mby5Ub3RhbEVuZW15QWxpdmUgLT0gMTtcclxuICAgICAgICAgICAgdGhpcy5ub2RlLmRlc3Ryb3koKTtcclxuICAgICAgICB9LCAxKTtcclxuXHJcbiAgICAgICAgdGhpcy5QbGF5ZXIucmVtb3ZlTmVhcmVzdEVuZW15KHRoaXMubm9kZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIGVmZmVjdERpZSgpe1xyXG4gICAgICAgIHRoaXMuSGVhbHRoQmFyLm5vZGUuYWN0aXZlID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IHJkID0gdGhpcy5ub2RlLmdldENvbXBvbmVudChjYy5SaWdpZEJvZHkpO1xyXG4gICAgICAgIHJkLnR5cGUgPSBjYy5SaWdpZEJvZHlUeXBlLkR5bmFtaWM7XHJcbiAgICAgICAgcmQuZ3Jhdml0eVNjYWxlID0gMC4xO1xyXG4gICAgICAgIHJkLmZpeGVkUm90YXRpb24gPSBmYWxzZTtcclxuXHJcbiAgICAgICAgY2MudHdlZW4odGhpcy5ub2RlKVxyXG4gICAgICAgIC50byAoMC41LCB7YW5nbGU6IDkwICogdGhpcy5nZXRTaWRlUGxheWVyKCl9KVxyXG4gICAgICAgIC5zdGFydCgpO1xyXG5cclxuICAgICAgICByZC5hcHBseUZvcmNlVG9DZW50ZXIoIGNjLnYyKChNYXRoLnJhbmRvbSgpICogMzAgKyAxMjApICogMjUwICogdGhpcy5nZXRTaWRlUGxheWVyKCksIChNYXRoLnJhbmRvbSgpICogMjAgKyA1MCkgKiAyNTApLCB0cnVlKTtcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0U2lkZVBsYXllcigpe1xyXG4gICAgICAgIGlmKHRoaXMuUGxheWVyLm5vZGUueCA+IHRoaXMubm9kZS54KSByZXR1cm4gLTE7XHJcbiAgICAgICAgcmV0dXJuIDE7XHJcbiAgICB9LFxyXG5cclxuICAgIG9uQ29sbGlzaW9uRW50ZXI6IGZ1bmN0aW9uIChvdGhlciwgc2VsZikge1xyXG4gICAgICAgIGlmKG90aGVyLm5vZGUuZ3JvdXAgPT0gXCJCb3hQbGF5ZXJcIil7XHJcbiAgICAgICAgICAgIHRoaXMuaGl0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBlbmRBdHRhY2soKXtcclxuICAgICAgICBpZih0aGlzLlNwZWVkIDw9IDAgfHwgdGhpcy5fc3RvcE1vdmUpe1xyXG4gICAgICAgICAgICB0aGlzLl9zdGF0ZSA9IEVuRW5lbXlTdGF0ZS5JZGxlO1xyXG4gICAgICAgICAgICB0aGlzLl9za2VsZXRvbi5zZXRBbmltYXRpb24oMCwgXCJpZGxlXCIsIHRydWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3N0YXRlID0gRW5FbmVteVN0YXRlLldhbGs7XHJcbiAgICAgICAgICAgIHRoaXMuX3NrZWxldG9uLnNldEFuaW1hdGlvbigwLCBcIndhbGtcIiwgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSxcclxufSk7XHJcbiJdfQ==