{"version":3,"sources":["assets\\Script\\Character\\Player3D.js"],"names":["require","EnFacing","EnWeapon","EnStickMode","EnStickState","CONST","GameInfo","AnimNameStick","HitCombos","ArcherCombos","HealthBar","ButtonAttack","AudioManager","cc","Class","Component","properties","Speed","DustParticle","ParticleSystem3D","DashParticle","BloodParticle","CustomeMoveBG","Node","ButtonLeft","ButtonRight","ButtonJump","ButtonDash","fakeSword","gameController","onLoad","window","isUsingFist","_originScaleX","InputMoveHorizontal","_onTheGround","_jumpCount","_isDashing","_velocityMaxX","_velocityMaxY","_runForce","_jumpForce","_jumpForce2","_dashForce","_runForceOnAttack","_velocityMaxXOnAttack","_checkPoint","node","getPosition","_isDeath","_isHasSword","_isHasArcher","_numDeath","_lastInputMoveHorizontal","_isWin","initEventAction","scaleX","_skeleton","getComponentInChildren","sp","Skeleton","_rigidBody","getComponent","RigidBody","_hitCombos","_archerCombos","setStartListener","trackEntry","animationName","animation","name","StickMode","Archer","onStartAnimation","setCompleteListener","onCompleteAnimation","setMixAnimation","changeWeapon","None","init","StickMaxHP","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyPressed","KEY_UP","onKeyReleased","TOUCH_START","event","flip","_tickHaft","tween","to","scale","start","TOUCH_END","TOUCH_CANCEL","attack","jump","dash","setMix","NormalIdle","NormalRun","NormalJumpB","NormalJumpC","NormalDashA","SwordIdle","SwordRun","SwordJumpB","SwordJumpC","SwordDashA","ArcherIdle","ArcherRun","ArcherJumpB","ArcherJumpC","ArcherDashA","StickState","Idle","setAnimation","_currentState","key_code","keyCode","macro","KEY","left","a","right","d","up","w","space","l","changeWeaponButton","weaponType","Sword","log","onClick","velocity","linearVelocity","v2","x","applyForceToCenter","play","scheduleOnce","dashSound","gravityScale","y","update","dt","TotalEnemyAlive","updateAnimation","showPopupInstall","isWin","win","IsOnAttackCombo","IsOnAttacking","Run","JumpUp","JumpDown","DashA","runSound","stop","onBeginContact","contact","selfCollider","otherCollider","tag","anim1","anim2","weaponId","Normal","setSword","isUsingSword","isUsingArrow","getItemSound","active","setArcher","changeFightMode","enabled","checkNearestEnemy","enemyNode","distance","removeNearestEnemy","hit","damp","decrement","isAlive","die","BoxCollider","SwordDie","ArcherDie","NormalDie","isLose","respawn","setPosition","onCollisionEnter","other","self","group","console","winSound","gameEnd","IsShowPopupInstall"],"mappings":";;;;;;AAAA,eAA0DA,OAAO,CAAC,UAAD,CAAjE;AAAA,IAAQC,QAAR,YAAQA,QAAR;AAAA,IAAkBC,QAAlB,YAAkBA,QAAlB;AAAA,IAA4BC,WAA5B,YAA4BA,WAA5B;AAAA,IAAyCC,YAAzC,YAAyCA,YAAzC;;AACA,IAAMC,KAAK,GAAGL,OAAO,CAAC,OAAD,CAArB;;AACA,IAAIM,QAAQ,GAAGN,OAAO,CAAC,UAAD,CAAtB;;AACA,IAAIO,aAAa,GAAGP,OAAO,CAAC,eAAD,CAA3B;;AACA,IAAIQ,SAAS,GAAGR,OAAO,CAAC,WAAD,CAAvB;;AACA,IAAIS,YAAY,GAAGT,OAAO,CAAC,cAAD,CAA1B;;AACA,IAAIU,SAAS,GAAGV,OAAO,CAAC,WAAD,CAAvB;;AACA,IAAIW,YAAY,GAAGX,OAAO,CAAC,cAAD,CAA1B;;AACA,IAAIY,YAAY,GAAGZ,OAAO,CAAC,cAAD,CAA1B;;AAEAa,EAAE,CAACC,KAAH,CAAS;AACL,aAASD,EAAE,CAACE,SADP;AAGLC,EAAAA,UAAU,EAAE;AACRC,IAAAA,KAAK,EAAG;AACJ,iBAAU;AADN,KADA;AAIRP,IAAAA,SAAS,EAAEA,SAJH;AAMR;AACAQ,IAAAA,YAAY,EAAEL,EAAE,CAACM,gBAPT;AAQRC,IAAAA,YAAY,EAAEP,EAAE,CAACM,gBART;AASRE,IAAAA,aAAa,EAAER,EAAE,CAACM,gBATV;AAWR;AACAG,IAAAA,aAAa,EAAET,EAAE,CAACU,IAZV;AAaRC,IAAAA,UAAU,EAAEX,EAAE,CAACU,IAbP;AAcRE,IAAAA,WAAW,EAAEZ,EAAE,CAACU,IAdR;AAeRZ,IAAAA,YAAY,EAAEE,EAAE,CAACU,IAfT;AAgBRG,IAAAA,UAAU,EAAEb,EAAE,CAACU,IAhBP;AAiBRI,IAAAA,UAAU,EAAEd,EAAE,CAACU,IAjBP;AAmBR;AACAK,IAAAA,SAAS,EAAEf,EAAE,CAACU,IApBN;AAqBRX,IAAAA,YAAY,EAAEA,YArBN;AAsBRiB,IAAAA,cAAc,EAAEhB,EAAE,CAACU,IAtBX,CAuBR;AACA;AACA;;AAzBQ,GAHP;AA+BLO,EAAAA,MA/BK,oBA+BK;AAAA;;AACN;AACAC,IAAAA,MAAM,CAACC,WAAP,GAAqB,IAArB;AAEA,SAAKC,aAAL,GAAqB,CAArB;AACA3B,IAAAA,QAAQ,CAAC4B,mBAAT,GAA+B,CAA/B;AACA,SAAKC,YAAL,GAAoB,KAApB;AACA,SAAKC,UAAL,GAAkB,CAAlB;AACA,SAAKC,UAAL,GAAkB,KAAlB;AAEA,SAAKC,aAAL,GAAqB,GAArB;AACA,SAAKC,aAAL,GAAqB,GAArB;AAEA,SAAKC,SAAL,GAAiB,IAAjB;AACA,SAAKC,UAAL,GAAkB,KAAlB;AACA,SAAKC,WAAL,GAAmB,KAAnB;AAEA,SAAKC,UAAL,GAAkB,KAAlB;AAEA,SAAKC,iBAAL,GAAyB,GAAzB;AACA,SAAKC,qBAAL,GAA6B,EAA7B;AAEA,SAAKC,WAAL,GAAmB,KAAKC,IAAL,CAAUC,WAAV,EAAnB;AAEA,SAAKC,QAAL,GAAgB,KAAhB;AAEA,SAAKC,WAAL,GAAmB,KAAnB;AAEA,SAAKC,YAAL,GAAoB,KAApB;AAEA,SAAKC,SAAL,GAAiB,CAAjB;AAEA,SAAKC,wBAAL,GAAgC,CAAhC;AAEA,SAAKC,MAAL,GAAc,KAAd;AAEA,SAAKC,eAAL,GApCM,CAsCN;;AACA,SAAKtB,aAAL,GAAqB,KAAKc,IAAL,CAAUS,MAA/B,CAvCM,CAyCN;;AAEA,SAAKC,SAAL,GAAiB,KAAKC,sBAAL,CAA4BC,EAAE,CAACC,QAA/B,CAAjB;AACA,SAAKC,UAAL,GAAkB,KAAKd,IAAL,CAAUe,YAAV,CAAuBjD,EAAE,CAACkD,SAA1B,CAAlB;AACA,SAAKC,UAAL,GAAkB,KAAKF,YAAL,CAAkBtD,SAAlB,CAAlB;AACA,SAAKyD,aAAL,GAAqB,KAAKH,YAAL,CAAkBrD,YAAlB,CAArB;;AAEA,SAAKgD,SAAL,CAAeS,gBAAf,CAAgC,UAAAC,UAAU,EAAI;AAC1C,UAAIC,aAAa,GAAGD,UAAU,CAACE,SAAX,GAAuBF,UAAU,CAACE,SAAX,CAAqBC,IAA5C,GAAmD,EAAvE;AACA,UAAGhE,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqE,MAArC,EAA6C,KAAI,CAACP,aAAL,CAAmBQ,gBAAnB,CAAoCL,aAApC,EAA7C,KACK,KAAI,CAACJ,UAAL,CAAgBS,gBAAhB,CAAiCL,aAAjC;AACR,KAJD;;AAMA,SAAKX,SAAL,CAAeiB,mBAAf,CAAmC,UAACP,UAAD,EAAgB;AAC/C,UAAIC,aAAa,GAAGD,UAAU,CAACE,SAAX,GAAuBF,UAAU,CAACE,SAAX,CAAqBC,IAA5C,GAAmD,EAAvE;AACA,UAAGhE,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqE,MAArC,EAA6C,KAAI,CAACP,aAAL,CAAmBU,mBAAnB,CAAuCP,aAAvC,EAA7C,KACK,KAAI,CAACJ,UAAL,CAAgBW,mBAAhB,CAAoCP,aAApC;AACR,KAJD;;AAMA,SAAKQ,eAAL;AAEA,SAAKC,YAAL,CAAkB3E,QAAQ,CAAC4E,IAA3B;AAEA,SAAKpE,SAAL,CAAeqE,IAAf,CAAoB1E,KAAK,CAAC2E,UAA1B;AACH,GAhGI;AAkGLzB,EAAAA,eAlGK,6BAkGY;AACb;AACA1C,IAAAA,EAAE,CAACoE,WAAH,CAAeC,EAAf,CAAkBrE,EAAE,CAACsE,WAAH,CAAeC,SAAf,CAAyBC,QAA3C,EAAqD,KAAKC,YAA1D,EAAwE,IAAxE;AACAzE,IAAAA,EAAE,CAACoE,WAAH,CAAeC,EAAf,CAAkBrE,EAAE,CAACsE,WAAH,CAAeC,SAAf,CAAyBG,MAA3C,EAAmD,KAAKC,aAAxD,EAAuE,IAAvE,EAHa,CAKb;;AACA,SAAKhE,UAAL,CAAgB0D,EAAhB,CAAmBrE,EAAE,CAACU,IAAH,CAAQ6D,SAAR,CAAkBK,WAArC,EAAkD,UAASC,KAAT,EAAe;AAC7D,UAAG,KAAKzC,QAAR,EAAkB;AAClB3C,MAAAA,QAAQ,CAAC4B,mBAAT,GAA+B,CAAC,CAAhC;AACA,WAAKyD,IAAL;AACA,WAAKC,SAAL,GAAiB,CAAjB;AACA/E,MAAAA,EAAE,CAACgF,KAAH,CAAS,KAAKrE,UAAd,EAA0BsE,EAA1B,CAA6B,GAA7B,EAAkC;AAACC,QAAAA,KAAK,EAAG;AAAT,OAAlC,EAAiD,IAAjD,EAAuDC,KAAvD;AAEA,WAAK3C,wBAAL,GAAgC,CAAC,CAAjC,CAP6D,CAS7D;AACA;AACH,KAXD,EAWG,IAXH;AAaA,SAAK7B,UAAL,CAAgB0D,EAAhB,CAAmBrE,EAAE,CAACU,IAAH,CAAQ6D,SAAR,CAAkBa,SAArC,EAAgD,UAASP,KAAT,EAAe;AAC3DpF,MAAAA,QAAQ,CAAC4B,mBAAT,GAA+B,CAA/B;AACArB,MAAAA,EAAE,CAACgF,KAAH,CAAS,KAAKrE,UAAd,EAA0BsE,EAA1B,CAA6B,GAA7B,EAAkC;AAACC,QAAAA,KAAK,EAAG;AAAT,OAAlC,EAA+C,IAA/C,EAAqDC,KAArD;AACH,KAHD,EAGG,IAHH;AAKA,SAAKxE,UAAL,CAAgB0D,EAAhB,CAAmBrE,EAAE,CAACU,IAAH,CAAQ6D,SAAR,CAAkBc,YAArC,EAAmD,UAASR,KAAT,EAAe;AAC9DpF,MAAAA,QAAQ,CAAC4B,mBAAT,GAA+B,CAA/B;AACArB,MAAAA,EAAE,CAACgF,KAAH,CAAS,KAAKrE,UAAd,EAA0BsE,EAA1B,CAA6B,GAA7B,EAAkC;AAACC,QAAAA,KAAK,EAAG;AAAT,OAAlC,EAA+C,IAA/C,EAAqDC,KAArD;AACH,KAHD,EAGG,IAHH,EAxBa,CA6Bb;;AACA,SAAKvE,WAAL,CAAiByD,EAAjB,CAAoBrE,EAAE,CAACU,IAAH,CAAQ6D,SAAR,CAAkBK,WAAtC,EAAmD,UAASC,KAAT,EAAe;AAC9D,UAAG,KAAKzC,QAAR,EAAkB;AAClB3C,MAAAA,QAAQ,CAAC4B,mBAAT,GAA+B,CAA/B;AACA,WAAK0D,SAAL,GAAiB,CAAjB;AACA,WAAKD,IAAL;AACA9E,MAAAA,EAAE,CAACgF,KAAH,CAAS,KAAKpE,WAAd,EAA2BqE,EAA3B,CAA8B,GAA9B,EAAmC;AAACC,QAAAA,KAAK,EAAG;AAAT,OAAnC,EAAkD,IAAlD,EAAwDC,KAAxD;AAEA,WAAK3C,wBAAL,GAAgC,CAAhC,CAP8D,CAQ9D;AACH,KATD,EASG,IATH;AAWA,SAAK5B,WAAL,CAAiByD,EAAjB,CAAoBrE,EAAE,CAACU,IAAH,CAAQ6D,SAAR,CAAkBa,SAAtC,EAAiD,UAASP,KAAT,EAAe;AAC5DpF,MAAAA,QAAQ,CAAC4B,mBAAT,GAA+B,CAA/B;AACArB,MAAAA,EAAE,CAACgF,KAAH,CAAS,KAAKpE,WAAd,EAA2BqE,EAA3B,CAA8B,GAA9B,EAAmC;AAACC,QAAAA,KAAK,EAAG;AAAT,OAAnC,EAAgD,IAAhD,EAAsDC,KAAtD;AACH,KAHD,EAGG,IAHH;AAKA,SAAKvE,WAAL,CAAiByD,EAAjB,CAAoBrE,EAAE,CAACU,IAAH,CAAQ6D,SAAR,CAAkBc,YAAtC,EAAoD,UAASR,KAAT,EAAe;AAC/DpF,MAAAA,QAAQ,CAAC4B,mBAAT,GAA+B,CAA/B;AACArB,MAAAA,EAAE,CAACgF,KAAH,CAAS,KAAKpE,WAAd,EAA2BqE,EAA3B,CAA8B,GAA9B,EAAmC;AAACC,QAAAA,KAAK,EAAG;AAAT,OAAnC,EAAgD,IAAhD,EAAsDC,KAAtD;AACH,KAHD,EAGG,IAHH,EA9Ca,CAmDb;AACA;AACA;AAEA;AACA;AACA;AAEA;;AACA,SAAKrF,YAAL,CAAkBuE,EAAlB,CAAqBrE,EAAE,CAACU,IAAH,CAAQ6D,SAAR,CAAkBK,WAAvC,EAAoD,UAASC,KAAT,EAAe;AAC/D;AACA,WAAKS,MAAL;AACAtF,MAAAA,EAAE,CAACgF,KAAH,CAAS,KAAKlF,YAAd,EAA4BmF,EAA5B,CAA+B,GAA/B,EAAoC;AAACC,QAAAA,KAAK,EAAG;AAAT,OAApC,EAAmD,IAAnD,EAAyDC,KAAzD;AACH,KAJD,EAIG,IAJH;AAMA,SAAKtE,UAAL,CAAgBwD,EAAhB,CAAmBrE,EAAE,CAACU,IAAH,CAAQ6D,SAAR,CAAkBK,WAArC,EAAkD,UAASC,KAAT,EAAe;AAC7D;AACA,WAAKU,IAAL;AACAvF,MAAAA,EAAE,CAACgF,KAAH,CAAS,KAAKnE,UAAd,EAA0BoE,EAA1B,CAA6B,GAA7B,EAAkC;AAACC,QAAAA,KAAK,EAAG;AAAT,OAAlC,EAAiD,IAAjD,EAAuDC,KAAvD;AACH,KAJD,EAIG,IAJH;AAMA,SAAKrE,UAAL,CAAgBuD,EAAhB,CAAmBrE,EAAE,CAACU,IAAH,CAAQ6D,SAAR,CAAkBK,WAArC,EAAkD,UAASC,KAAT,EAAe;AAC7D;AACA,WAAKW,IAAL;AACAxF,MAAAA,EAAE,CAACgF,KAAH,CAAS,KAAKlE,UAAd,EAA0BmE,EAA1B,CAA6B,GAA7B,EAAkC;AAACC,QAAAA,KAAK,EAAG;AAAT,OAAlC,EAAiD,IAAjD,EAAuDC,KAAvD;AACH,KAJD,EAIG,IAJH;AAMA,SAAKrF,YAAL,CAAkBuE,EAAlB,CAAqBrE,EAAE,CAACU,IAAH,CAAQ6D,SAAR,CAAkBa,SAAvC,EAAkD,UAASP,KAAT,EAAe;AAC7D,WAAKS,MAAL;AACAtF,MAAAA,EAAE,CAACgF,KAAH,CAAS,KAAKlF,YAAd,EAA4BmF,EAA5B,CAA+B,GAA/B,EAAoC;AAACC,QAAAA,KAAK,EAAG;AAAT,OAApC,EAAiD,IAAjD,EAAuDC,KAAvD;AACH,KAHD,EAGG,IAHH;AAKA,SAAKtE,UAAL,CAAgBwD,EAAhB,CAAmBrE,EAAE,CAACU,IAAH,CAAQ6D,SAAR,CAAkBa,SAArC,EAAgD,UAASP,KAAT,EAAe;AAC3D,WAAKU,IAAL;AACAvF,MAAAA,EAAE,CAACgF,KAAH,CAAS,KAAKnE,UAAd,EAA0BoE,EAA1B,CAA6B,GAA7B,EAAkC;AAACC,QAAAA,KAAK,EAAG;AAAT,OAAlC,EAA+C,IAA/C,EAAqDC,KAArD;AACH,KAHD,EAGG,IAHH;AAKA,SAAKrE,UAAL,CAAgBuD,EAAhB,CAAmBrE,EAAE,CAACU,IAAH,CAAQ6D,SAAR,CAAkBa,SAArC,EAAgD,UAASP,KAAT,EAAe;AAC3D,WAAKW,IAAL;AACAxF,MAAAA,EAAE,CAACgF,KAAH,CAAS,KAAKlE,UAAd,EAA0BmE,EAA1B,CAA6B,GAA7B,EAAkC;AAACC,QAAAA,KAAK,EAAG;AAAT,OAAlC,EAA+C,IAA/C,EAAqDC,KAArD;AACH,KAHD,EAGG,IAHH,EAxFa,CA8Fb;AACA;AACA;AACA;AAEA;AACA;AACA;AACH,GAxMI;AA0MLpB,EAAAA,eA1MK,6BA0MY;AACb,SAAK0B,MAAL,CAAY/F,aAAa,CAACgG,UAA1B,EAAsChG,aAAa,CAACiG,SAApD;AACA,SAAKF,MAAL,CAAY/F,aAAa,CAACgG,UAA1B,EAAsChG,aAAa,CAACkG,WAApD;AACA,SAAKH,MAAL,CAAY/F,aAAa,CAACgG,UAA1B,EAAsChG,aAAa,CAACmG,WAApD;AACA,SAAKJ,MAAL,CAAY/F,aAAa,CAACgG,UAA1B,EAAsChG,aAAa,CAACoG,WAApD;AAEA,SAAKL,MAAL,CAAY/F,aAAa,CAACiG,SAA1B,EAAqCjG,aAAa,CAACkG,WAAnD;AACA,SAAKH,MAAL,CAAY/F,aAAa,CAACiG,SAA1B,EAAqCjG,aAAa,CAACmG,WAAnD;AACA,SAAKJ,MAAL,CAAY/F,aAAa,CAACiG,SAA1B,EAAqCjG,aAAa,CAACoG,WAAnD;AAEA,SAAKL,MAAL,CAAY/F,aAAa,CAACoG,WAA1B,EAAuCpG,aAAa,CAACkG,WAArD;AACA,SAAKH,MAAL,CAAY/F,aAAa,CAACoG,WAA1B,EAAuCpG,aAAa,CAACmG,WAArD;AAEA,SAAKJ,MAAL,CAAY/F,aAAa,CAACkG,WAA1B,EAAuClG,aAAa,CAACmG,WAArD,EAba,CAeb;;AACA,SAAKJ,MAAL,CAAY/F,aAAa,CAACqG,SAA1B,EAAqCrG,aAAa,CAACsG,QAAnD;AACA,SAAKP,MAAL,CAAY/F,aAAa,CAACqG,SAA1B,EAAqCrG,aAAa,CAACuG,UAAnD;AACA,SAAKR,MAAL,CAAY/F,aAAa,CAACqG,SAA1B,EAAqCrG,aAAa,CAACwG,UAAnD;AACA,SAAKT,MAAL,CAAY/F,aAAa,CAACqG,SAA1B,EAAqCrG,aAAa,CAACyG,UAAnD;AAEA,SAAKV,MAAL,CAAY/F,aAAa,CAACsG,QAA1B,EAAoCtG,aAAa,CAACuG,UAAlD;AACA,SAAKR,MAAL,CAAY/F,aAAa,CAACsG,QAA1B,EAAoCtG,aAAa,CAACwG,UAAlD;AACA,SAAKT,MAAL,CAAY/F,aAAa,CAACsG,QAA1B,EAAoCtG,aAAa,CAACyG,UAAlD;AAEA,SAAKV,MAAL,CAAY/F,aAAa,CAACyG,UAA1B,EAAsCzG,aAAa,CAACuG,UAApD;AACA,SAAKR,MAAL,CAAY/F,aAAa,CAACyG,UAA1B,EAAsCzG,aAAa,CAACwG,UAApD;AAEA,SAAKT,MAAL,CAAY/F,aAAa,CAACuG,UAA1B,EAAsCvG,aAAa,CAACwG,UAApD,EA5Ba,CA8Bb;;AACA,SAAKT,MAAL,CAAY/F,aAAa,CAAC0G,UAA1B,EAAsC1G,aAAa,CAAC2G,SAApD;AACA,SAAKZ,MAAL,CAAY/F,aAAa,CAAC0G,UAA1B,EAAsC1G,aAAa,CAAC4G,WAApD;AACA,SAAKb,MAAL,CAAY/F,aAAa,CAAC0G,UAA1B,EAAsC1G,aAAa,CAAC6G,WAApD;AACA,SAAKd,MAAL,CAAY/F,aAAa,CAAC0G,UAA1B,EAAsC1G,aAAa,CAAC8G,WAApD;AAEA,SAAKf,MAAL,CAAY/F,aAAa,CAAC2G,SAA1B,EAAqC3G,aAAa,CAAC4G,WAAnD;AACA,SAAKb,MAAL,CAAY/F,aAAa,CAAC2G,SAA1B,EAAqC3G,aAAa,CAAC6G,WAAnD;AACA,SAAKd,MAAL,CAAY/F,aAAa,CAAC2G,SAA1B,EAAqC3G,aAAa,CAAC8G,WAAnD;AAEA,SAAKf,MAAL,CAAY/F,aAAa,CAAC8G,WAA1B,EAAuC9G,aAAa,CAAC4G,WAArD;AACA,SAAKb,MAAL,CAAY/F,aAAa,CAAC8G,WAA1B,EAAuC9G,aAAa,CAAC6G,WAArD;AAEA,SAAKd,MAAL,CAAY/F,aAAa,CAAC4G,WAA1B,EAAuC5G,aAAa,CAAC6G,WAArD;AACH,GAtPI;AAwPLpB,EAAAA,KAxPK,mBAwPI;AACL1F,IAAAA,QAAQ,CAACgH,UAAT,GAAsBlH,YAAY,CAACmH,IAAnC;;AAEA,SAAK9D,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAACgG,UAA7C,EAAyD,IAAzD;;AACA,SAAKkB,aAAL,GAAqBrH,YAAY,CAACmH,IAAlC;AACH,GA7PI;AA+PLjC,EAAAA,YA/PK,wBA+PQI,KA/PR,EA+Pc;AAEf,QAAIgC,QAAQ,GAAGhC,KAAK,CAACiC,OAArB;;AAEA,YAAOD,QAAP;AAEI,WAAK7G,EAAE,CAAC+G,KAAH,CAASC,GAAT,CAAaC,IAAlB;AACA,WAAKjH,EAAE,CAAC+G,KAAH,CAASC,GAAT,CAAaE,CAAlB;AACI,YAAG,KAAK9E,QAAR,EAAkB;AAClB3C,QAAAA,QAAQ,CAAC4B,mBAAT,GAA+B,CAAC,CAAhC;AACA,aAAK0D,SAAL,GAAiB,CAAjB;AACA,aAAKD,IAAL;AACJ;;AAEA,WAAK9E,EAAE,CAAC+G,KAAH,CAASC,GAAT,CAAaG,KAAlB;AACA,WAAKnH,EAAE,CAAC+G,KAAH,CAASC,GAAT,CAAaI,CAAlB;AACI,YAAG,KAAKhF,QAAR,EAAkB;AAClB3C,QAAAA,QAAQ,CAAC4B,mBAAT,GAA+B,CAA/B;AACA,aAAK0D,SAAL,GAAiB,CAAjB;AACA,aAAKD,IAAL;AACJ;;AAEA,WAAK9E,EAAE,CAAC+G,KAAH,CAASC,GAAT,CAAaK,EAAlB;AACA,WAAKrH,EAAE,CAAC+G,KAAH,CAASC,GAAT,CAAaM,CAAlB;AACI,aAAK/B,IAAL;AACJ;;AAEA,WAAKvF,EAAE,CAAC+G,KAAH,CAASC,GAAT,CAAaO,KAAlB;AACI,aAAK/B,IAAL;AACJ;;AAEA,WAAKxF,EAAE,CAAC+G,KAAH,CAASC,GAAT,CAAaQ,CAAlB;AACI,aAAKlC,MAAL;AACJ;AA7BJ;AAiCH,GApSI;AAsSLX,EAAAA,aAtSK,yBAsSSE,KAtST,EAsSe;AAEhB,QAAIgC,QAAQ,GAAGhC,KAAK,CAACiC,OAArB;;AAEA,YAAOD,QAAP;AAEI,WAAK7G,EAAE,CAAC+G,KAAH,CAASC,GAAT,CAAaC,IAAlB;AACA,WAAKjH,EAAE,CAAC+G,KAAH,CAASC,GAAT,CAAaE,CAAlB;AACA,WAAKlH,EAAE,CAAC+G,KAAH,CAASC,GAAT,CAAaG,KAAlB;AACA,WAAKnH,EAAE,CAAC+G,KAAH,CAASC,GAAT,CAAaI,CAAlB;AACI3H,QAAAA,QAAQ,CAAC4B,mBAAT,GAA+B,CAA/B;AACJ;AAPJ;AASH,GAnTI;AAqTLoG,EAAAA,kBArTK,8BAqTcC,UArTd,EAqTyB;AAC1B,QAAGA,UAAU,IAAIrI,QAAQ,CAACsI,KAA1B,EAAgC;AAC5B,UAAGlI,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqI,KAArC,EAA2C;AACvC,aAAK3D,YAAL,CAAkB3E,QAAQ,CAAC4E,IAA3B;AACH,OAFD,MAEO;AACH,YAAG,KAAK5B,WAAR,EAAoB;AAChB,eAAK2B,YAAL,CAAkB3E,QAAQ,CAACsI,KAA3B;AACH,SAFD,MAEO;AACH3H,UAAAA,EAAE,CAAC4H,GAAH,CAAO,mBAAP;AACH;AACJ;AACJ,KAVD,MAUO,IAAGF,UAAU,IAAIrI,QAAQ,CAACsE,MAA1B,EAAiC;AACpC,UAAGlE,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqE,MAArC,EAA4C;AACxC,aAAKK,YAAL,CAAkB3E,QAAQ,CAAC4E,IAA3B;AACH,OAFD,MAEO;AACH,YAAG,KAAK3B,YAAR,EAAqB;AACjB,eAAK0B,YAAL,CAAkB3E,QAAQ,CAACsE,MAA3B;AACH,SAFD,MAEO;AACH3D,UAAAA,EAAE,CAAC4H,GAAH,CAAO,mBAAP;AACH;AACJ;AACJ;AACJ,GA3UI;AA6ULtC,EAAAA,MA7UK,oBA6UG;AACJ,QAAG,KAAKlD,QAAR,EAAkB;;AAElB,QAAG3C,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqE,MAArC,EAA4C;AACxC,WAAKP,aAAL,CAAmByE,OAAnB;AACH,KAFD,MAEO;AACH,WAAK1E,UAAL,CAAgB0E,OAAhB;AACH;AACJ,GArVI;AAuVLtC,EAAAA,IAvVK,kBAuVC;AACF;AACA,QAAG,KAAKnD,QAAR,EAAkB;AAElB,QAAG,KAAKZ,UAAR,EAAoB;;AAEpB,QAAG,KAAKF,YAAR,EAAqB;AACjB,UAAIwG,QAAQ,GAAG,KAAK9E,UAAL,CAAgB+E,cAA/B;AACA,WAAK/E,UAAL,CAAgB+E,cAAhB,GAAiC/H,EAAE,CAACgI,EAAH,CAAMF,QAAQ,CAACG,CAAf,EAAkB,CAAC,GAAnB,CAAjC,CAFiB,CAIjB;;AACA,WAAKjF,UAAL,CAAgBkF,kBAAhB,CAAoClI,EAAE,CAACgI,EAAH,CAAM,CAAN,EAAQ,KAAKpG,UAAb,CAApC,EAA+D,IAA/D;;AACA,WAAKN,YAAL,GAAoB,KAApB;AAEA,WAAKjB,YAAL,CAAkB8H,IAAlB;AAEA,WAAKC,YAAL,CAAkB,YAAW;AACzB,aAAK7G,UAAL,GAAkB,CAAlB;AACH,OAFD,EAEG,IAFH;AAGA;AACH;;AAED,QAAG,CAAC,KAAKD,YAAN,IAAsB,KAAKC,UAAL,IAAmB,CAA5C,EAA8C;AAC1C,UAAIuG,SAAQ,GAAG,KAAK9E,UAAL,CAAgB+E,cAA/B;AACA,WAAK/E,UAAL,CAAgB+E,cAAhB,GAAiC/H,EAAE,CAACgI,EAAH,CAAMF,SAAQ,CAACG,CAAf,EAAkB,CAAC,GAAnB,CAAjC,CAF0C,CAI1C;;AACA,WAAKjF,UAAL,CAAgBkF,kBAAhB,CAAoClI,EAAE,CAACgI,EAAH,CAAM,CAAN,EAAQ,KAAKnG,WAAb,CAApC,EAAgE,IAAhE;;AACA,WAAKP,YAAL,GAAoB,KAApB;AACA,WAAKC,UAAL,GAAkB,CAAlB;AAEA,WAAKlB,YAAL,CAAkB8H,IAAlB;AACA;AACH;AACJ,GAzXI;AA2XL3C,EAAAA,IA3XK,kBA2XC;AACF;AACA,QAAG,KAAKpD,QAAR,EAAkB;AAClB,SAAKrC,YAAL,CAAkBsI,SAAlB,CAA4BF,IAA5B;AACA,SAAK3G,UAAL,GAAkB,IAAlB;;AACA,SAAKwB,UAAL,CAAgBkF,kBAAhB,CAAoClI,EAAE,CAACgI,EAAH,CAAM,KAAKlG,UAAL,GAAkB,CAAlB,GAAsB,KAAKI,IAAL,CAAUS,MAAtC,EAA8C,CAA9C,CAApC,EAAuF,IAAvF;;AACA,SAAKK,UAAL,CAAgBsF,YAAhB,GAA+B,GAA/B;AAEA,SAAK/H,YAAL,CAAkB4H,IAAlB;AAEA,SAAKC,YAAL,CAAkB,YAAW;AACzB,WAAK5G,UAAL,GAAkB,KAAlB;AACA,WAAKwB,UAAL,CAAgBsF,YAAhB,GAA+B,CAA/B;AACA,UAAIR,QAAQ,GAAG,KAAK9E,UAAL,CAAgB+E,cAA/B;AACA,WAAK/E,UAAL,CAAgB+E,cAAhB,GAAiC/H,EAAE,CAACgI,EAAH,CAAM,CAAN,EAASF,QAAQ,CAACS,CAAlB,CAAjC;AACH,KALD,EAKG,IALH;AAMH,GA3YI;AA6YLzD,EAAAA,IA7YK,kBA6YC;AACF,SAAK5C,IAAL,CAAUS,MAAV,GAAmB,KAAKvB,aAAL,GAAqB3B,QAAQ,CAAC4B,mBAAjD;AACH,GA/YI;AAiZLmH,EAAAA,MAjZK,kBAiZGC,EAjZH,EAiZO;AACR,QAAG,KAAKrG,QAAR,EAAkB;;AAElB,QAAG3C,QAAQ,CAACiJ,eAAT,IAA4B,CAA/B,EAAkC;AAC9B,WAAKC,eAAL;AACA,WAAKC,gBAAL;AACAnJ,MAAAA,QAAQ,CAACoJ,KAAT,GAAiB,IAAjB;AACA,WAAKpG,MAAL,GAAc,IAAd;AACA,WAAKL,QAAL,GAAgB,IAAhB;AACA,WAAK0G,GAAL;AACH;;AAED,QAAIf,cAAc,GAAG,KAAK/E,UAAL,CAAgB+E,cAArC,CAZQ,CAcR;AACA;;AACA,QAAG,KAAK5E,UAAL,CAAgB4F,eAAhB,IAAmC,KAAK3F,aAAL,CAAmB4F,aAAzD,EAAuE;AACnE;AACA,UAAK,CAAC,KAAKxH,UAAN,IAAoB/B,QAAQ,CAAC4B,mBAAT,GAA+B,CAAnD,IAAwD0G,cAAc,CAACE,CAAf,GAAmB,KAAKjG,qBAAjF,IAA4GvC,QAAQ,CAAC4B,mBAAT,GAA+B,CAA/B,IAAoC0G,cAAc,CAACE,CAAf,GAAmB,CAAC,KAAKjG,qBAA7K,EAAqM;AACjM,aAAKgB,UAAL,CAAgBkF,kBAAhB,CAAoClI,EAAE,CAACgI,EAAH,CAAMvI,QAAQ,CAAC4B,mBAAT,GAA+B,KAAKU,iBAA1C,EAA6D,CAA7D,CAApC,EAAsG,IAAtG;AACH;AACJ,KALD,MAKO;AACH;AACA,UAAK,CAAC,KAAKP,UAAN,IAAoB/B,QAAQ,CAAC4B,mBAAT,GAA+B,CAAnD,IAAwD0G,cAAc,CAACE,CAAf,GAAmB,KAAKxG,aAAjF,IAAoGhC,QAAQ,CAAC4B,mBAAT,GAA+B,CAA/B,IAAoC0G,cAAc,CAACE,CAAf,GAAmB,CAAC,KAAKxG,aAArK,EAAqL;AACjL,aAAKuB,UAAL,CAAgBkF,kBAAhB,CAAoClI,EAAE,CAACgI,EAAH,CAAMvI,QAAQ,CAAC4B,mBAAT,GAA+B,KAAKM,SAA1C,EAAqD,CAArD,CAApC,EAA8F,IAA9F;AACH;AACJ;;AAED,QAAGoG,cAAc,CAACE,CAAf,GAAmB,IAAnB,IAA2BF,cAAc,CAACE,CAAf,GAAmB,CAAC,IAAlD,EAAuD;AACnDxI,MAAAA,QAAQ,CAACgH,UAAT,GAAsBlH,YAAY,CAAC0J,GAAnC;;AACA,UAAG,KAAKlE,SAAL,IAAkB,CAArB,EAAuB;AACnB,aAAK1E,YAAL,CAAkB8H,IAAlB;AACA,aAAKpD,SAAL,GAAiB,GAAjB;AACH;;AAED,WAAKA,SAAL,IAAkB0D,EAAlB;AACH;;AAED,QAAGV,cAAc,CAACQ,CAAf,GAAmB,IAAtB,EAA6B9I,QAAQ,CAACgH,UAAT,GAAsBlH,YAAY,CAAC2J,MAAnC,CAA7B,KACK,IAAGnB,cAAc,CAACQ,CAAf,GAAmB,CAAC,IAAvB,EAA8B9I,QAAQ,CAACgH,UAAT,GAAsBlH,YAAY,CAAC4J,QAAnC;AAEnC,QAAG,KAAK3H,UAAR,EAAqB/B,QAAQ,CAACgH,UAAT,GAAsBlH,YAAY,CAAC6J,KAAnC;;AAErB,QAAGrB,cAAc,CAACE,CAAf,IAAoB,IAApB,IAA4BF,cAAc,CAACE,CAAf,IAAoB,CAAC,IAAjD,IACAF,cAAc,CAACQ,CAAf,IAAoB,IADpB,IAC4BR,cAAc,CAACQ,CAAf,IAAoB,CAAC,IADpD,EAC0D;AAEtD9I,MAAAA,QAAQ,CAACgH,UAAT,GAAsBlH,YAAY,CAACmH,IAAnC;AACA,WAAK3G,YAAL,CAAkBsJ,QAAlB,CAA2BC,IAA3B;AACH;;AAED,SAAKX,eAAL,GAlDQ,CAoDR;AACA;AACA;AACA;AACH,GAzcI;AA2cLA,EAAAA,eA3cK,6BA2cY;AACb,QAAG,KAAK/B,aAAL,IAAuBnH,QAAQ,CAACgH,UAAnC,EAA+C;AAE/C,QAAG,KAAKtD,UAAL,CAAgB4F,eAAnB,EAAoC;AAEpC,QAAG,KAAK3G,QAAR,EAAkB;;AAElB,YAAQ3C,QAAQ,CAACgH,UAAjB;AACI,WAAKlH,YAAY,CAACmH,IAAlB;AACI,YAAIjH,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqI,KAAtC,EAA4C;AACxC,eAAK/E,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAACqG,SAA7C,EAAwD,IAAxD;AACH,SAFD,MAEO,IAAItG,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqE,MAAtC,EAA6C;AAChD,eAAKf,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAAC0G,UAA7C,EAAyD,IAAzD;AACH,SAFM,MAEA;AACH,eAAKxD,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAACgG,UAA7C,EAAyD,IAAzD;AACH;;AACD;;AACJ,WAAKnG,YAAY,CAAC0J,GAAlB;AACI,YAAIxJ,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqI,KAAtC,EAA4C;AACxC,eAAK5H,YAAL,CAAkBsJ,QAAlB,CAA2BlB,IAA3B;;AACA,eAAKvF,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAACsG,QAA7C,EAAuD,IAAvD;AACH,SAHD,MAGO,IAAIvG,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqE,MAAtC,EAA6C;AAChD,eAAK5D,YAAL,CAAkBsJ,QAAlB,CAA2BlB,IAA3B;;AACA,eAAKvF,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAAC2G,SAA7C,EAAwD,IAAxD;AACH,SAHM,MAGA;AACH,eAAKtG,YAAL,CAAkBsJ,QAAlB,CAA2BlB,IAA3B;;AACA,eAAKvF,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAACiG,SAA7C,EAAwD,IAAxD;AACH;;AACD;;AACJ,WAAKpG,YAAY,CAAC2J,MAAlB;AACI,YAAIzJ,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqI,KAAtC,EAA4C;AACxC,eAAK5H,YAAL,CAAkBsI,SAAlB,CAA4BF,IAA5B;;AACA,eAAKvF,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAACuG,UAA7C,EAAyD,IAAzD;AACH,SAHD,MAGO,IAAIxG,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqE,MAAtC,EAA6C;AAChD,eAAK5D,YAAL,CAAkBsI,SAAlB,CAA4BF,IAA5B;;AACA,eAAKvF,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAAC4G,WAA7C,EAA0D,IAA1D;AACH,SAHM,MAGA;AACH,eAAKvG,YAAL,CAAkBsI,SAAlB,CAA4BF,IAA5B;;AACA,eAAKvF,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAACkG,WAA7C,EAA0D,IAA1D;AACH;;AACD;;AACJ,WAAKrG,YAAY,CAAC4J,QAAlB;AACI,YAAI1J,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqI,KAAtC,EAA4C;AACxC,eAAK/E,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAACwG,UAA7C,EAAyD,IAAzD;AACH,SAFD,MAEO,IAAIzG,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqE,MAAtC,EAA6C;AAChD,eAAKf,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAAC6G,WAA7C,EAA0D,IAA1D;AACH,SAFM,MAEA;AACH,eAAK3D,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAACmG,WAA7C,EAA0D,IAA1D;AACH;;AACD;;AACJ,WAAKtG,YAAY,CAAC6J,KAAlB;AACI,YAAI3J,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqI,KAAtC,EAA4C;AACxC,eAAK/E,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAACyG,UAA7C,EAAyD,IAAzD;AACH,SAFD,MAEO,IAAI1G,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqE,MAAtC,EAA6C;AAChD,eAAKf,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAAC8G,WAA7C,EAA0D,IAA1D;AACH,SAFM,MAEA;AACH,eAAK5D,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAACoG,WAA7C,EAA0D,IAA1D;AACH;;AACD;;AACJ,WAAKvG,YAAY,CAAC6J,KAAlB;AACI,YAAI3J,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqI,KAAtC,EAA4C;AACxC,eAAK/E,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAACyG,UAA7C,EAAyD,IAAzD;AACH,SAFD,MAEO,IAAI1G,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqE,MAAtC,EAA6C;AAChD,eAAKf,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAAC8G,WAA7C,EAA0D,IAA1D;AACH,SAFM,MAEA;AACH,eAAK5D,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAACoG,WAA7C,EAA0D,IAA1D;AACH;;AACD;AA5DR;;AA+DA,SAAKc,aAAL,GAAsBnH,QAAQ,CAACgH,UAA/B;AACH,GAlhBI;AAohBL8C,EAAAA,cAphBK,0BAohBUC,OAphBV,EAohBmBC,YAphBnB,EAohBiCC,aAphBjC,EAohB+C;AAChD;AACA,QAAGD,YAAY,CAACE,GAAb,IAAoB,CAAvB,EAAyB;AACrB,WAAKrI,YAAL,GAAoB,IAApB;AACH;AACJ,GAzhBI;AA2hBLmE,EAAAA,MA3hBK,kBA2hBEmE,KA3hBF,EA2hBSC,KA3hBT,EA2hBe;AAChB,SAAKjH,SAAL,CAAe6C,MAAf,CAAsBmE,KAAtB,EAA6BC,KAA7B,EAAoC,GAApC;AACH,GA7hBI;AA+hBL7F,EAAAA,YA/hBK,wBA+hBQ8F,QA/hBR,EA+hBiB;AAClB,QAAIA,QAAQ,IAAIzK,QAAQ,CAAC4E,IAAzB,EAA8B;AAC1BxE,MAAAA,QAAQ,CAACiE,SAAT,GAAqBpE,WAAW,CAACyK,MAAjC;AACH,KAFD,MAEO,IAAID,QAAQ,IAAIzK,QAAQ,CAACsI,KAAzB,EAA+B;AAClClI,MAAAA,QAAQ,CAACiE,SAAT,GAAqBpE,WAAW,CAACqI,KAAjC;AACA,WAAKtF,WAAL,GAAmB,IAAnB;AACA,WAAKvC,YAAL,CAAkBmD,YAAlB,CAA+BnD,YAA/B,EAA6CkK,QAA7C;AACA9I,MAAAA,MAAM,CAAC+I,YAAP,GAAsB,IAAtB;AACA/I,MAAAA,MAAM,CAACgJ,YAAP,GAAsB,KAAtB;AACAhJ,MAAAA,MAAM,CAACC,WAAP,GAAqB,KAArB;AACA,WAAKpB,YAAL,CAAkBoK,YAAlB,CAA+BhC,IAA/B;AACA,WAAKpH,SAAL,CAAeqJ,MAAf,GAAwB,IAAxB;AACH,KATM,MASA,IAAIN,QAAQ,IAAIzK,QAAQ,CAACsE,MAAzB,EAAgC;AACnClE,MAAAA,QAAQ,CAACiE,SAAT,GAAqBpE,WAAW,CAACqE,MAAjC;AACA,WAAKrB,YAAL,GAAoB,IAApB;AACApB,MAAAA,MAAM,CAAC+I,YAAP,GAAsB,KAAtB;AACA/I,MAAAA,MAAM,CAACgJ,YAAP,GAAsB,IAAtB;AACAhJ,MAAAA,MAAM,CAACC,WAAP,GAAqB,KAArB;AACA,WAAKrB,YAAL,CAAkBmD,YAAlB,CAA+BnD,YAA/B,EAA6CuK,SAA7C;AACA,WAAKtK,YAAL,CAAkBoK,YAAlB,CAA+BhC,IAA/B;AACA,WAAKpH,SAAL,CAAeqJ,MAAf,GAAwB,KAAxB;AACH;;AAED,SAAKE,eAAL;AACH,GAvjBI;AAyjBLA,EAAAA,eAzjBK,6BAyjBY;AACbtK,IAAAA,EAAE,CAAC4H,GAAH,CAAO,aAAP,EAAsBnI,QAAQ,CAACiE,SAA/B;AACA,SAAKkD,aAAL,GAAqBrH,YAAY,CAAC0E,IAAlC;;AAEA,QAAGxE,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqE,MAArC,EAA4C;AACxC,WAAKP,aAAL,CAAmBmH,OAAnB,GAA6B,IAA7B;AACA,WAAKpH,UAAL,CAAgBoH,OAAhB,GAA0B,KAA1B;AACH,KAHD,MAGO;AACH,WAAKnH,aAAL,CAAmBmH,OAAnB,GAA6B,KAA7B;AACA,WAAKpH,UAAL,CAAgBoH,OAAhB,GAA0B,IAA1B;AACH;AACJ,GApkBI;AAskBLC,EAAAA,iBAtkBK,6BAskBaC,SAtkBb,EAskBwBC,QAtkBxB,EAskBkC;AACnC,SAAKtH,aAAL,CAAmBoH,iBAAnB,CAAqCC,SAArC,EAAgDC,QAAhD;AACH,GAxkBI;AA0kBLC,EAAAA,kBA1kBK,8BA0kBcF,SA1kBd,EA0kByB;AAC1B,SAAKrH,aAAL,CAAmBuH,kBAAnB,CAAsCF,SAAtC;AACH,GA5kBI;AA8kBLG,EAAAA,GA9kBK,eA8kBDC,IA9kBC,EA8kBI;AACL;AACA,QAAG,KAAKzI,QAAR,EAAkB;AAElB,SAAKvC,SAAL,CAAeiL,SAAf,CAAyBD,IAAzB;AAEA,SAAKrK,aAAL,CAAmB2H,IAAnB;;AAEA,QAAG,CAAC,KAAKtI,SAAL,CAAekL,OAAf,EAAJ,EAA6B;AACzB,WAAKC,GAAL;AACH;AACJ,GAzlBI;AA2lBLA,EAAAA,GA3lBK,iBA2lBA;AACD,SAAK5I,QAAL,GAAgB,IAAhB;AAEA,SAAKF,IAAL,CAAUe,YAAV,CAAuBjD,EAAE,CAACiL,WAA1B,EAAuCV,OAAvC,GAAiD,KAAjD;;AAEA,QAAI9K,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqI,KAAtC,EAA4C;AACxC,WAAK/E,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAACwL,QAA7C,EAAuD,KAAvD;AACH,KAFD,MAEO,IAAIzL,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqE,MAAtC,EAA6C;AAChD,WAAKf,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAACyL,SAA7C,EAAwD,KAAxD;AACH,KAFM,MAEA;AACH,WAAKvI,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAAC0L,SAA7C,EAAwD,KAAxD;AACH;;AAED3L,IAAAA,QAAQ,CAAC4L,MAAT,GAAkB,IAAlB;AACA,SAAKzC,gBAAL,GAdC,CAgBD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEH,GArnBI;AAunBL0C,EAAAA,OAvnBK,qBAunBI;AACL,SAAKlJ,QAAL,GAAgB,KAAhB;AACA,SAAKF,IAAL,CAAUS,MAAV,GAAmB,CAAnB;AACA,SAAKT,IAAL,CAAUe,YAAV,CAAuBjD,EAAE,CAACiL,WAA1B,EAAuCV,OAAvC,GAAiD,IAAjD;AACA,SAAKrI,IAAL,CAAUqJ,WAAV,CAAsB,KAAKtJ,WAAL,CAAiBgG,CAAvC,EAA0C,KAAKhG,WAAL,CAAiBsG,CAA3D;AAEA,SAAK1I,SAAL,CAAeqE,IAAf,CAAoB1E,KAAK,CAAC2E,UAA1B;;AAEA,QAAI1E,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqI,KAAtC,EAA4C;AACxC,WAAK/E,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAACqG,SAA7C,EAAwD,IAAxD;AACH,KAFD,MAEO,IAAItG,QAAQ,CAACiE,SAAT,IAAsBpE,WAAW,CAACqE,MAAtC,EAA6C;AAChD,WAAKf,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAAC0G,UAA7C,EAAyD,IAAzD;AACH,KAFM,MAEA;AACH,WAAKxD,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAACgG,UAA7C,EAAyD,IAAzD;AACH;AACJ,GAtoBI;AAwoBL8F,EAAAA,gBAAgB,EAAE,0BAAUC,KAAV,EAAiBC,IAAjB,EAAuB;AACrC,QAAGD,KAAK,CAACvJ,IAAN,CAAWyJ,KAAX,IAAoB,MAAvB,EAA8B;AAC1BC,MAAAA,OAAO,CAAChE,GAAR,CAAY,WAAZ;AAEA,WAAKoD,GAAL;AACH;AACJ,GA9oBI;AAgpBLlC,EAAAA,GAhpBK,iBAgpBA;AACD,SAAK1G,QAAL,GAAgB,IAAhB;AAEA,SAAKF,IAAL,CAAUe,YAAV,CAAuBjD,EAAE,CAACiL,WAA1B,EAAuCV,OAAvC,GAAiD,KAAjD;;AAEA,SAAK3H,SAAL,CAAe+D,YAAf,CAA4B,CAA5B,EAA+BjH,aAAa,CAAC0G,UAA7C,EAAyD,IAAzD;;AAEA3G,IAAAA,QAAQ,CAACoJ,KAAT,GAAiB,IAAjB;AAEA,SAAKD,gBAAL;AACH,GA1pBI;AA4pBLA,EAAAA,gBA5pBK,8BA4pBa;AACd,SAAK7I,YAAL,CAAkBsJ,QAAlB,CAA2BC,IAA3B;AACA,SAAKvJ,YAAL,CAAkB8L,QAAlB,CAA2B1D,IAA3B;AACAyD,IAAAA,OAAO,CAAChE,GAAR,CAAY,iCAAZ;AACA1G,IAAAA,MAAM,CAAC4K,OAAP,IAAkB5K,MAAM,CAAC4K,OAAP,EAAlB;AAEA,SAAK1D,YAAL,CAAkB,YAAU;AACxB3I,MAAAA,QAAQ,CAACsM,kBAAT,GAA8B,IAA9B;AACH,KAFD,EAEG,CAFH;AAGH;AArqBI,CAAT","sourceRoot":"/","sourcesContent":["const { EnFacing, EnWeapon, EnStickMode, EnStickState } = require(\"GameEnum\");\r\nconst CONST = require(\"CONST\");\r\nvar GameInfo = require(\"GameInfo\");\r\nvar AnimNameStick = require(\"AnimNameStick\");\r\nvar HitCombos = require(\"HitCombos\");\r\nvar ArcherCombos = require(\"ArcherCombos\");\r\nvar HealthBar = require(\"HealthBar\");\r\nvar ButtonAttack = require(\"ButtonAttack\");\r\nvar AudioManager = require(\"AudioManager\");\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        Speed : {\r\n            default : 7,\r\n        },\r\n        HealthBar: HealthBar,\r\n\r\n        // Particle effect\r\n        DustParticle: cc.ParticleSystem3D,\r\n        DashParticle: cc.ParticleSystem3D,\r\n        BloodParticle: cc.ParticleSystem3D,\r\n\r\n        // Action Button Input\r\n        CustomeMoveBG: cc.Node,\r\n        ButtonLeft: cc.Node,\r\n        ButtonRight: cc.Node,\r\n        ButtonAttack: cc.Node,\r\n        ButtonJump: cc.Node,\r\n        ButtonDash: cc.Node,\r\n\r\n        // DhHiepp\r\n        fakeSword: cc.Node,\r\n        AudioManager: AudioManager,\r\n        gameController: cc.Node,\r\n        // Button Weapon Side\r\n        // ButtonSword: cc.Node,\r\n        // ButtonArcher: cc.Node,\r\n    },\r\n\r\n    onLoad () {\r\n        // Init Variable\r\n        window.isUsingFist = true;\r\n\r\n        this._originScaleX = 1;\r\n        GameInfo.InputMoveHorizontal = 0;\r\n        this._onTheGround = false;\r\n        this._jumpCount = 0;\r\n        this._isDashing = false;\r\n\r\n        this._velocityMaxX = 120;\r\n        this._velocityMaxY = 120;\r\n\r\n        this._runForce = 3500;\r\n        this._jumpForce = 21000;\r\n        this._jumpForce2 = 25000;\r\n\r\n        this._dashForce = 10000;\r\n\r\n        this._runForceOnAttack = 300;\r\n        this._velocityMaxXOnAttack = 25;\r\n\r\n        this._checkPoint = this.node.getPosition();\r\n\r\n        this._isDeath = false;\r\n\r\n        this._isHasSword = false;\r\n\r\n        this._isHasArcher = false;\r\n\r\n        this._numDeath = 0;\r\n\r\n        this._lastInputMoveHorizontal = 0;\r\n\r\n        this._isWin = false;\r\n\r\n        this.initEventAction();\r\n        \r\n        // Set default variable\r\n        this._originScaleX = this.node.scaleX;\r\n\r\n        // this.PopupInstall.active = false;\r\n\r\n        this._skeleton = this.getComponentInChildren(sp.Skeleton);\r\n        this._rigidBody = this.node.getComponent(cc.RigidBody);\r\n        this._hitCombos = this.getComponent(HitCombos);\r\n        this._archerCombos = this.getComponent(ArcherCombos);\r\n\r\n        this._skeleton.setStartListener(trackEntry => {\r\n            var animationName = trackEntry.animation ? trackEntry.animation.name : \"\";\r\n            if(GameInfo.StickMode == EnStickMode.Archer) this._archerCombos.onStartAnimation(animationName);\r\n            else this._hitCombos.onStartAnimation(animationName);\r\n        });\r\n\r\n        this._skeleton.setCompleteListener((trackEntry) => {\r\n            var animationName = trackEntry.animation ? trackEntry.animation.name : \"\";\r\n            if(GameInfo.StickMode == EnStickMode.Archer) this._archerCombos.onCompleteAnimation(animationName);\r\n            else this._hitCombos.onCompleteAnimation(animationName);\r\n        });\r\n\r\n        this.setMixAnimation();\r\n\r\n        this.changeWeapon(EnWeapon.None);\r\n\r\n        this.HealthBar.init(CONST.StickMaxHP);\r\n    },\r\n\r\n    initEventAction(){\r\n        // Init Events\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyPressed, this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyReleased, this);\r\n\r\n        // Event Button Move Left\r\n        this.ButtonLeft.on(cc.Node.EventType.TOUCH_START, function(event){\r\n            if(this._isDeath) return;\r\n            GameInfo.InputMoveHorizontal = -1;\r\n            this.flip();\r\n            this._tickHaft = 0;\r\n            cc.tween(this.ButtonLeft).to(0.2, {scale : 0.9}, this).start();\r\n\r\n            this._lastInputMoveHorizontal = -1;\r\n\r\n            // ironsource\r\n            // this.gameController.getComponent(\"GameController\").handleIronSourcePlaySound();\r\n        }, this);\r\n\r\n        this.ButtonLeft.on(cc.Node.EventType.TOUCH_END, function(event){\r\n            GameInfo.InputMoveHorizontal = 0;\r\n            cc.tween(this.ButtonLeft).to(0.2, {scale : 1}, this).start();\r\n        }, this);\r\n\r\n        this.ButtonLeft.on(cc.Node.EventType.TOUCH_CANCEL, function(event){\r\n            GameInfo.InputMoveHorizontal = 0;\r\n            cc.tween(this.ButtonLeft).to(0.2, {scale : 1}, this).start();\r\n        }, this);\r\n\r\n        // Event Button Move Right\r\n        this.ButtonRight.on(cc.Node.EventType.TOUCH_START, function(event){\r\n            if(this._isDeath) return;\r\n            GameInfo.InputMoveHorizontal = 1;\r\n            this._tickHaft = 0;\r\n            this.flip();\r\n            cc.tween(this.ButtonRight).to(0.2, {scale : 0.9}, this).start();\r\n\r\n            this._lastInputMoveHorizontal = 1;\r\n            // this.gameController.getComponent(\"GameController\").handleIronSourcePlaySound();\r\n        }, this);\r\n\r\n        this.ButtonRight.on(cc.Node.EventType.TOUCH_END, function(event){\r\n            GameInfo.InputMoveHorizontal = 0;\r\n            cc.tween(this.ButtonRight).to(0.2, {scale : 1}, this).start();\r\n        }, this);\r\n\r\n        this.ButtonRight.on(cc.Node.EventType.TOUCH_CANCEL, function(event){\r\n            GameInfo.InputMoveHorizontal = 0;\r\n            cc.tween(this.ButtonRight).to(0.2, {scale : 1}, this).start();\r\n        }, this);\r\n\r\n        // this.CustomeMoveBG.on(cc.Node.EventType.TOUCH_START, function(event){\r\n        //     GameInfo.InputMoveHorizontal = this._lastInputMoveHorizontal;\r\n        // }, this);\r\n\r\n        // this.CustomeMoveBG.on(cc.Node.EventType.TOUCH_CANCEL, function(event){\r\n        //     GameInfo.InputMoveHorizontal = 0;\r\n        // }, this);\r\n\r\n        // Event Button Attack\r\n        this.ButtonAttack.on(cc.Node.EventType.TOUCH_START, function(event){\r\n            // this.gameController.getComponent(\"GameController\").handleIronSourcePlaySound();\r\n            this.attack();\r\n            cc.tween(this.ButtonAttack).to(0.2, {scale : 0.9}, this).start();\r\n        }, this);\r\n\r\n        this.ButtonJump.on(cc.Node.EventType.TOUCH_START, function(event){\r\n            // this.gameController.getComponent(\"GameController\").handleIronSourcePlaySound();\r\n            this.jump();\r\n            cc.tween(this.ButtonJump).to(0.2, {scale : 0.9}, this).start();\r\n        }, this);\r\n\r\n        this.ButtonDash.on(cc.Node.EventType.TOUCH_START, function(event){\r\n            // this.gameController.getComponent(\"GameController\").handleIronSourcePlaySound();\r\n            this.dash();\r\n            cc.tween(this.ButtonDash).to(0.2, {scale : 0.9}, this).start();\r\n        }, this);\r\n\r\n        this.ButtonAttack.on(cc.Node.EventType.TOUCH_END, function(event){\r\n            this.attack();\r\n            cc.tween(this.ButtonAttack).to(0.2, {scale : 1}, this).start();\r\n        }, this);\r\n\r\n        this.ButtonJump.on(cc.Node.EventType.TOUCH_END, function(event){\r\n            this.jump();\r\n            cc.tween(this.ButtonJump).to(0.2, {scale : 1}, this).start();\r\n        }, this);\r\n\r\n        this.ButtonDash.on(cc.Node.EventType.TOUCH_END, function(event){\r\n            this.dash();\r\n            cc.tween(this.ButtonDash).to(0.2, {scale : 1}, this).start();\r\n        }, this);\r\n\r\n\r\n        // Event Change Weapon\r\n        // this.ButtonSword.on(cc.Node.EventType.TOUCH_START, function(event){\r\n        //     this.changeWeaponButton(EnWeapon.Sword);\r\n        // }, this);\r\n\r\n        // this.ButtonArcher.on(cc.Node.EventType.TOUCH_START, function(event){\r\n        //     this.changeWeaponButton(EnWeapon.Archer);\r\n        // }, this);\r\n    },\r\n\r\n    setMixAnimation(){\r\n        this.setMix(AnimNameStick.NormalIdle, AnimNameStick.NormalRun);\r\n        this.setMix(AnimNameStick.NormalIdle, AnimNameStick.NormalJumpB);\r\n        this.setMix(AnimNameStick.NormalIdle, AnimNameStick.NormalJumpC);\r\n        this.setMix(AnimNameStick.NormalIdle, AnimNameStick.NormalDashA);\r\n\r\n        this.setMix(AnimNameStick.NormalRun, AnimNameStick.NormalJumpB);\r\n        this.setMix(AnimNameStick.NormalRun, AnimNameStick.NormalJumpC);\r\n        this.setMix(AnimNameStick.NormalRun, AnimNameStick.NormalDashA);\r\n\r\n        this.setMix(AnimNameStick.NormalDashA, AnimNameStick.NormalJumpB);\r\n        this.setMix(AnimNameStick.NormalDashA, AnimNameStick.NormalJumpC);\r\n\r\n        this.setMix(AnimNameStick.NormalJumpB, AnimNameStick.NormalJumpC);\r\n\r\n        // Mix Sword Anim\r\n        this.setMix(AnimNameStick.SwordIdle, AnimNameStick.SwordRun);\r\n        this.setMix(AnimNameStick.SwordIdle, AnimNameStick.SwordJumpB);\r\n        this.setMix(AnimNameStick.SwordIdle, AnimNameStick.SwordJumpC);\r\n        this.setMix(AnimNameStick.SwordIdle, AnimNameStick.SwordDashA);\r\n\r\n        this.setMix(AnimNameStick.SwordRun, AnimNameStick.SwordJumpB);\r\n        this.setMix(AnimNameStick.SwordRun, AnimNameStick.SwordJumpC);\r\n        this.setMix(AnimNameStick.SwordRun, AnimNameStick.SwordDashA);\r\n\r\n        this.setMix(AnimNameStick.SwordDashA, AnimNameStick.SwordJumpB);\r\n        this.setMix(AnimNameStick.SwordDashA, AnimNameStick.SwordJumpC);\r\n\r\n        this.setMix(AnimNameStick.SwordJumpB, AnimNameStick.SwordJumpC);\r\n\r\n        // Mix Archer Anim\r\n        this.setMix(AnimNameStick.ArcherIdle, AnimNameStick.ArcherRun);\r\n        this.setMix(AnimNameStick.ArcherIdle, AnimNameStick.ArcherJumpB);\r\n        this.setMix(AnimNameStick.ArcherIdle, AnimNameStick.ArcherJumpC);\r\n        this.setMix(AnimNameStick.ArcherIdle, AnimNameStick.ArcherDashA);\r\n\r\n        this.setMix(AnimNameStick.ArcherRun, AnimNameStick.ArcherJumpB);\r\n        this.setMix(AnimNameStick.ArcherRun, AnimNameStick.ArcherJumpC);\r\n        this.setMix(AnimNameStick.ArcherRun, AnimNameStick.ArcherDashA);\r\n\r\n        this.setMix(AnimNameStick.ArcherDashA, AnimNameStick.ArcherJumpB);\r\n        this.setMix(AnimNameStick.ArcherDashA, AnimNameStick.ArcherJumpC);\r\n\r\n        this.setMix(AnimNameStick.ArcherJumpB, AnimNameStick.ArcherJumpC);\r\n    },\r\n\r\n    start () {\r\n        GameInfo.StickState = EnStickState.Idle;\r\n\r\n        this._skeleton.setAnimation(0, AnimNameStick.NormalIdle, true);\r\n        this._currentState = EnStickState.Idle;\r\n    },\r\n\r\n    onKeyPressed(event){\r\n\r\n        let key_code = event.keyCode;\r\n\r\n        switch(key_code){\r\n\r\n            case cc.macro.KEY.left:\r\n            case cc.macro.KEY.a:\r\n                if(this._isDeath) return;\r\n                GameInfo.InputMoveHorizontal = -1;\r\n                this._tickHaft = 0;\r\n                this.flip();\r\n            break;\r\n\r\n            case cc.macro.KEY.right:\r\n            case cc.macro.KEY.d:\r\n                if(this._isDeath) return;\r\n                GameInfo.InputMoveHorizontal = 1;\r\n                this._tickHaft = 0;\r\n                this.flip();\r\n            break;\r\n\r\n            case cc.macro.KEY.up:\r\n            case cc.macro.KEY.w:\r\n                this.jump();\r\n            break;\r\n\r\n            case cc.macro.KEY.space:\r\n                this.dash();\r\n            break;\r\n\r\n            case cc.macro.KEY.l:\r\n                this.attack();\r\n            break;\r\n\r\n        }\r\n\r\n    },\r\n\r\n    onKeyReleased(event){\r\n\r\n        let key_code = event.keyCode;\r\n\r\n        switch(key_code){\r\n\r\n            case cc.macro.KEY.left:\r\n            case cc.macro.KEY.a:\r\n            case cc.macro.KEY.right:\r\n            case cc.macro.KEY.d:\r\n                GameInfo.InputMoveHorizontal = 0;\r\n            break;\r\n        }\r\n    },\r\n\r\n    changeWeaponButton(weaponType){\r\n        if(weaponType == EnWeapon.Sword){\r\n            if(GameInfo.StickMode == EnStickMode.Sword){\r\n                this.changeWeapon(EnWeapon.None);\r\n            } else {\r\n                if(this._isHasSword){\r\n                    this.changeWeapon(EnWeapon.Sword);\r\n                } else {\r\n                    cc.log(\"No Sword Found!!!\");\r\n                }\r\n            }\r\n        } else if(weaponType == EnWeapon.Archer){\r\n            if(GameInfo.StickMode == EnStickMode.Archer){\r\n                this.changeWeapon(EnWeapon.None);\r\n            } else {\r\n                if(this._isHasArcher){\r\n                    this.changeWeapon(EnWeapon.Archer);\r\n                } else {\r\n                    cc.log(\"No Sword Found!!!\");\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    attack(){\r\n        if(this._isDeath) return;\r\n        \r\n        if(GameInfo.StickMode == EnStickMode.Archer){\r\n            this._archerCombos.onClick();\r\n        } else {\r\n            this._hitCombos.onClick();\r\n        }\r\n    },\r\n\r\n    jump(){\r\n        // Jump\r\n        if(this._isDeath) return;\r\n\r\n        if(this._isDashing) return;\r\n\r\n        if(this._onTheGround){\r\n            let velocity = this._rigidBody.linearVelocity;\r\n            this._rigidBody.linearVelocity = cc.v2(velocity.x, -100);\r\n\r\n            // console.log(\"First Jump\");\r\n            this._rigidBody.applyForceToCenter( cc.v2(0,this._jumpForce) , true );\r\n            this._onTheGround = false;\r\n\r\n            this.DustParticle.play();\r\n\r\n            this.scheduleOnce(function() {\r\n                this._jumpCount = 1;\r\n            }, 0.15);\r\n            return;\r\n        }\r\n\r\n        if(!this._onTheGround && this._jumpCount == 1){\r\n            let velocity = this._rigidBody.linearVelocity;\r\n            this._rigidBody.linearVelocity = cc.v2(velocity.x, -100);\r\n            \r\n            // console.log(\"Second Jump \" + velocity);\r\n            this._rigidBody.applyForceToCenter( cc.v2(0,this._jumpForce2) , true );\r\n            this._onTheGround = false;\r\n            this._jumpCount = 0;\r\n\r\n            this.DustParticle.play();\r\n            return;\r\n        }\r\n    },\r\n\r\n    dash(){\r\n        // Dash\r\n        if(this._isDeath) return;\r\n        this.AudioManager.dashSound.play();\r\n        this._isDashing = true;\r\n        this._rigidBody.applyForceToCenter( cc.v2(this._dashForce * 3 * this.node.scaleX, 0) , true );\r\n        this._rigidBody.gravityScale = 0.5;\r\n\r\n        this.DashParticle.play();\r\n\r\n        this.scheduleOnce(function() {\r\n            this._isDashing = false;\r\n            this._rigidBody.gravityScale = 1;\r\n            let velocity = this._rigidBody.linearVelocity;\r\n            this._rigidBody.linearVelocity = cc.v2(0, velocity.y);\r\n        }, 0.25);\r\n    },\r\n\r\n    flip(){\r\n        this.node.scaleX = this._originScaleX * GameInfo.InputMoveHorizontal;\r\n    },\r\n\r\n    update (dt) {\r\n        if(this._isDeath) return;\r\n\r\n        if(GameInfo.TotalEnemyAlive <= 1) {\r\n            this.updateAnimation();\r\n            this.showPopupInstall();\r\n            GameInfo.isWin = true;\r\n            this._isWin = true;\r\n            this._isDeath = true;\r\n            this.win();\r\n        } \r\n\r\n        let linearVelocity = this._rigidBody.linearVelocity;\r\n\r\n        // this.node.x += this.Speed * 10 * dt * GameInfo.InputMoveHorizontal;\r\n        // cc.log(\"Is Attack Combo: \", this._hitCombos.IsOnAttackCombo);\r\n        if(this._hitCombos.IsOnAttackCombo || this._archerCombos.IsOnAttacking){\r\n            // Force Slow when on attack combo\r\n            if( (!this._isDashing && GameInfo.InputMoveHorizontal > 0 && linearVelocity.x < this._velocityMaxXOnAttack) || (GameInfo.InputMoveHorizontal < 0 && linearVelocity.x > -this._velocityMaxXOnAttack) ){\r\n                this._rigidBody.applyForceToCenter( cc.v2(GameInfo.InputMoveHorizontal * this._runForceOnAttack, 0) , true );\r\n            }\r\n        } else {\r\n            // Force Normal when on attack combo\r\n            if( (!this._isDashing && GameInfo.InputMoveHorizontal > 0 && linearVelocity.x < this._velocityMaxX) || (GameInfo.InputMoveHorizontal < 0 && linearVelocity.x > -this._velocityMaxX) ){\r\n                this._rigidBody.applyForceToCenter( cc.v2(GameInfo.InputMoveHorizontal * this._runForce, 0) , true );\r\n            }\r\n        }\r\n\r\n        if(linearVelocity.x > 0.01 || linearVelocity.x < -0.01){\r\n            GameInfo.StickState = EnStickState.Run;\r\n            if(this._tickHaft <= 0){\r\n                this.DustParticle.play();\r\n                this._tickHaft = 0.5;\r\n            }\r\n\r\n            this._tickHaft -= dt;\r\n        }\r\n\r\n        if(linearVelocity.y > 0.01)  GameInfo.StickState = EnStickState.JumpUp;\r\n        else if(linearVelocity.y < -0.01)  GameInfo.StickState = EnStickState.JumpDown;\r\n\r\n        if(this._isDashing)  GameInfo.StickState = EnStickState.DashA;\r\n        \r\n        if(linearVelocity.x <= 0.01 && linearVelocity.x >= -0.01\r\n        && linearVelocity.y <= 0.01 && linearVelocity.y >= -0.01) {\r\n\r\n            GameInfo.StickState = EnStickState.Idle;\r\n            this.AudioManager.runSound.stop();\r\n        }\r\n\r\n        this.updateAnimation();\r\n\r\n        // if(!this._isWin && GameInfo.TotalEnemyAlive <= 0){\r\n        //     this._isWin = true;\r\n        //     this.win();\r\n        // }\r\n    },\r\n\r\n    updateAnimation(){\r\n        if(this._currentState ==  GameInfo.StickState) return;\r\n\r\n        if(this._hitCombos.IsOnAttackCombo) return;\r\n\r\n        if(this._isDeath) return;\r\n\r\n        switch( GameInfo.StickState){\r\n            case EnStickState.Idle:\r\n                if (GameInfo.StickMode == EnStickMode.Sword){\r\n                    this._skeleton.setAnimation(0, AnimNameStick.SwordIdle, true);\r\n                } else if (GameInfo.StickMode == EnStickMode.Archer){\r\n                    this._skeleton.setAnimation(0, AnimNameStick.ArcherIdle, true);\r\n                } else {\r\n                    this._skeleton.setAnimation(0, AnimNameStick.NormalIdle, true);\r\n                }\r\n                break;\r\n            case EnStickState.Run:\r\n                if (GameInfo.StickMode == EnStickMode.Sword){\r\n                    this.AudioManager.runSound.play();\r\n                    this._skeleton.setAnimation(0, AnimNameStick.SwordRun, true);\r\n                } else if (GameInfo.StickMode == EnStickMode.Archer){\r\n                    this.AudioManager.runSound.play();\r\n                    this._skeleton.setAnimation(0, AnimNameStick.ArcherRun, true);\r\n                } else {\r\n                    this.AudioManager.runSound.play();\r\n                    this._skeleton.setAnimation(0, AnimNameStick.NormalRun, true);\r\n                }\r\n                break;\r\n            case EnStickState.JumpUp:\r\n                if (GameInfo.StickMode == EnStickMode.Sword){\r\n                    this.AudioManager.dashSound.play();\r\n                    this._skeleton.setAnimation(0, AnimNameStick.SwordJumpB, true);\r\n                } else if (GameInfo.StickMode == EnStickMode.Archer){\r\n                    this.AudioManager.dashSound.play();\r\n                    this._skeleton.setAnimation(0, AnimNameStick.ArcherJumpB, true);\r\n                } else {\r\n                    this.AudioManager.dashSound.play();\r\n                    this._skeleton.setAnimation(0, AnimNameStick.NormalJumpB, true);\r\n                }\r\n                break;\r\n            case EnStickState.JumpDown:\r\n                if (GameInfo.StickMode == EnStickMode.Sword){\r\n                    this._skeleton.setAnimation(0, AnimNameStick.SwordJumpC, true);\r\n                } else if (GameInfo.StickMode == EnStickMode.Archer){\r\n                    this._skeleton.setAnimation(0, AnimNameStick.ArcherJumpC, true);\r\n                } else {\r\n                    this._skeleton.setAnimation(0, AnimNameStick.NormalJumpC, true);\r\n                }\r\n                break;\r\n            case EnStickState.DashA:\r\n                if (GameInfo.StickMode == EnStickMode.Sword){\r\n                    this._skeleton.setAnimation(0, AnimNameStick.SwordDashA, true);\r\n                } else if (GameInfo.StickMode == EnStickMode.Archer){\r\n                    this._skeleton.setAnimation(0, AnimNameStick.ArcherDashA, true);\r\n                } else {\r\n                    this._skeleton.setAnimation(0, AnimNameStick.NormalDashA, true);\r\n                }\r\n                break;\r\n            case EnStickState.DashA:\r\n                if (GameInfo.StickMode == EnStickMode.Sword){\r\n                    this._skeleton.setAnimation(0, AnimNameStick.SwordDashA, true);\r\n                } else if (GameInfo.StickMode == EnStickMode.Archer){\r\n                    this._skeleton.setAnimation(0, AnimNameStick.ArcherDashA, true);\r\n                } else {\r\n                    this._skeleton.setAnimation(0, AnimNameStick.NormalDashA, true);\r\n                }\r\n                break;\r\n        }\r\n\r\n        this._currentState =  GameInfo.StickState;\r\n    },\r\n\r\n    onBeginContact(contact, selfCollider, otherCollider){\r\n        // console.log(\"Begin Contact: \" + selfCollider.tag);\r\n        if(selfCollider.tag == 2){\r\n            this._onTheGround = true;\r\n        }\r\n    },\r\n\r\n    setMix(anim1, anim2){\r\n        this._skeleton.setMix(anim1, anim2, 0.1);\r\n    },\r\n\r\n    changeWeapon(weaponId){\r\n        if (weaponId == EnWeapon.None){\r\n            GameInfo.StickMode = EnStickMode.Normal;\r\n        } else if (weaponId == EnWeapon.Sword){\r\n            GameInfo.StickMode = EnStickMode.Sword;\r\n            this._isHasSword = true;\r\n            this.ButtonAttack.getComponent(ButtonAttack).setSword();\r\n            window.isUsingSword = true;\r\n            window.isUsingArrow = false;\r\n            window.isUsingFist = false;\r\n            this.AudioManager.getItemSound.play();\r\n            this.fakeSword.active = true;\r\n        } else if (weaponId == EnWeapon.Archer){\r\n            GameInfo.StickMode = EnStickMode.Archer;\r\n            this._isHasArcher = true;\r\n            window.isUsingSword = false;\r\n            window.isUsingArrow = true;\r\n            window.isUsingFist = false;\r\n            this.ButtonAttack.getComponent(ButtonAttack).setArcher();\r\n            this.AudioManager.getItemSound.play();\r\n            this.fakeSword.active = false;\r\n        }\r\n        \r\n        this.changeFightMode();\r\n    },\r\n\r\n    changeFightMode(){\r\n        cc.log(\"Fight Mode \", GameInfo.StickMode);\r\n        this._currentState = EnStickState.None;\r\n\r\n        if(GameInfo.StickMode == EnStickMode.Archer){\r\n            this._archerCombos.enabled = true;\r\n            this._hitCombos.enabled = false;\r\n        } else {\r\n            this._archerCombos.enabled = false;\r\n            this._hitCombos.enabled = true;\r\n        }\r\n    },\r\n\r\n    checkNearestEnemy(enemyNode, distance) {\r\n        this._archerCombos.checkNearestEnemy(enemyNode, distance);\r\n    },\r\n\r\n    removeNearestEnemy(enemyNode) {\r\n        this._archerCombos.removeNearestEnemy(enemyNode);\r\n    },\r\n\r\n    hit(damp){\r\n        // console.log(\"Hit Player \", damp);\r\n        if(this._isDeath) return;\r\n\r\n        this.HealthBar.decrement(damp);\r\n\r\n        this.BloodParticle.play();\r\n\r\n        if(!this.HealthBar.isAlive()){\r\n            this.die();\r\n        }\r\n    },\r\n\r\n    die(){\r\n        this._isDeath = true;\r\n\r\n        this.node.getComponent(cc.BoxCollider).enabled = false;\r\n\r\n        if (GameInfo.StickMode == EnStickMode.Sword){\r\n            this._skeleton.setAnimation(0, AnimNameStick.SwordDie, false);\r\n        } else if (GameInfo.StickMode == EnStickMode.Archer){\r\n            this._skeleton.setAnimation(0, AnimNameStick.ArcherDie, false);\r\n        } else {\r\n            this._skeleton.setAnimation(0, AnimNameStick.NormalDie, false);\r\n        }\r\n\r\n        GameInfo.isLose = true;\r\n        this.showPopupInstall();\r\n\r\n        // if(this._numDeath < CONST.NumDeathShowInstall){\r\n        //     this.scheduleOnce(function(){\r\n        //         this.respawn();\r\n        //     }, 2);\r\n        //     this._numDeath += 1;\r\n        // } else {\r\n        //     GameInfo.isLose = true;\r\n        //     this.showPopupInstall();\r\n        // }\r\n        \r\n    },\r\n\r\n    respawn(){\r\n        this._isDeath = false;\r\n        this.node.scaleX = 1;\r\n        this.node.getComponent(cc.BoxCollider).enabled = true;\r\n        this.node.setPosition(this._checkPoint.x, this._checkPoint.y);\r\n\r\n        this.HealthBar.init(CONST.StickMaxHP);\r\n\r\n        if (GameInfo.StickMode == EnStickMode.Sword){\r\n            this._skeleton.setAnimation(0, AnimNameStick.SwordIdle, true);\r\n        } else if (GameInfo.StickMode == EnStickMode.Archer){\r\n            this._skeleton.setAnimation(0, AnimNameStick.ArcherIdle, true);\r\n        } else {\r\n            this._skeleton.setAnimation(0, AnimNameStick.NormalIdle, true);\r\n        }\r\n    },\r\n\r\n    onCollisionEnter: function (other, self) {\r\n        if(other.node.group == \"Trap\"){\r\n            console.log(\"Fall Trap\");\r\n\r\n            this.die();\r\n        }\r\n    },\r\n\r\n    win(){\r\n        this._isDeath = true;\r\n\r\n        this.node.getComponent(cc.BoxCollider).enabled = false;\r\n\r\n        this._skeleton.setAnimation(0, AnimNameStick.ArcherIdle, true);\r\n\r\n        GameInfo.isWin = true;\r\n\r\n        this.showPopupInstall();\r\n    },\r\n\r\n    showPopupInstall(){\r\n        this.AudioManager.runSound.stop();\r\n        this.AudioManager.winSound.play();\r\n        console.log(\"Call Window End - Popup Instakk\");\r\n        window.gameEnd && window.gameEnd();\r\n\r\n        this.scheduleOnce(function(){\r\n            GameInfo.IsShowPopupInstall = true;\r\n        }, 2);\r\n    }\r\n});\r\n"]}