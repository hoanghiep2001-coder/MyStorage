{"version":3,"sources":["file:///D:/CocosProjects/Amobear/Squid/assets/Script/Options/PA_30/Others/HayChonGiaDung.ts"],"names":["_decorator","Component","easing","log","Node","tween","Vec3","GameInfo","ccclass","property","HayChonGiaDung","start","Roll","children","forEach","child","name","includes","meters","push","icon_roll","meter","active","activeHayChonGiaDung","getCurrentRollResult","result","currentTween","stop","currentRotate","eulerAngles","z","Squid_PA_30","detachCandySteps","trueSteps1","boxChoosen","moveDetachedCandy","wrong","currentPos","node","getPosition","currentScale","getScale","to","position","x","y","scale","smooth","call","nextDetach","destroy","index","length","element","startRotation","endRotation","repeatForever"],"mappings":"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","sourcesContent":["\nimport { _decorator, Component, easing, log, Node, Tween, tween, TweenAction, Vec3 } from 'cc';\nimport { GameInfo } from '../../../CONST/GameInfo';\nimport { BoxBehavior } from '../Box/BoxBehavior';\nconst { ccclass, property } = _decorator;\n\n\n@ccclass('HayChonGiaDung')\nexport class HayChonGiaDung extends Component {\n\n    @property(Node)\n    Roll: Node = null;\n    icon_roll: Node = null;\n    meters: Node[] = [];\n\n    boxChoosen: BoxBehavior = null;\n\n    currentTween: Tween<Node> = null;\n\n\n    public trueSteps1: number[] = [40, -40];\n    public trueSteps2: number[] = [40, -55];\n    public trueSteps3: number[] = [40, -14, -41, -80];\n    public trueSteps4: number[] = [40, -55];\n\n\n    protected start(): void {\n        this.Roll.children.forEach(child => {\n            if (child.name.includes(\"meter\")) this.meters.push(child);\n            else this.icon_roll = child;\n        });\n\n        this.meters.forEach(meter => meter.active = false);\n        this.meters[0].active = true;\n\n        this.activeHayChonGiaDung();\n    }\n\n\n    public getCurrentRollResult(): boolean {\n        let result = false;\n\n        this.currentTween.stop();\n\n        let currentRotate: number = this.icon_roll.eulerAngles.z;\n\n        switch (GameInfo.Squid_PA_30.detachCandySteps) {\n            case 1:\n                if (currentRotate >= this.trueSteps1[1] && currentRotate <= this.trueSteps1[0]) {\n                    this.boxChoosen.moveDetachedCandy();\n                    return true;\n                }\n                else return false;\n                break;\n            case 2:\n                if (currentRotate >= this.trueSteps1[1] && currentRotate <= this.trueSteps1[0]) {\n                    this.boxChoosen.moveDetachedCandy();\n                    return true;\n                }\n                else return false;\n                break;\n            case 3:\n                if ((currentRotate >= this.trueSteps1[1] && currentRotate <= this.trueSteps1[0])\n                    || (currentRotate >= this.trueSteps1[3] && currentRotate <= this.trueSteps1[2])\n                ) {\n                    this.boxChoosen.moveDetachedCandy();\n                    return true;\n                }\n                else return false;\n                break;\n            case 4:\n                if (currentRotate >= this.trueSteps1[1] && currentRotate <= this.trueSteps1[0]) {\n                    this.boxChoosen.moveDetachedCandy();\n                    return true;\n                }\n                else return false;\n                break;\n            default:\n                break;\n        }\n\n        return result;\n    }\n\n\n    public wrong(): void {\n        log(\"wrong!\")\n        let currentPos = this.node.getPosition();\n        let currentScale = this.node.getScale();\n        tween(this.node)\n            .to(0.1, {\n                position: new Vec3(currentPos.x + 5, currentPos.y, currentPos.z),\n                scale: new Vec3(currentScale.x + 0.03, currentScale.y + 0.03)\n            }, { easing: easing.smooth })\n            .to(0.1, { position: currentPos, scale: currentScale }, { easing: easing.smooth })\n            .call(() => this.activeHayChonGiaDung())\n            .start();\n    }\n\n\n    public nextDetach(): void {\n        log(\"correct!\")\n        GameInfo.Squid_PA_30.detachCandySteps += 1;\n\n        if(GameInfo.Squid_PA_30.detachCandySteps >= 5) {\n            this.node.active = false;\n            this.destroy()\n        }\n\n        for (let index = 0; index < this.meters.length; index++) {\n            const element = this.meters[index];\n            element.active = false;\n            if (index === GameInfo.Squid_PA_30.detachCandySteps - 1) element.active = true;\n        }\n        this.activeHayChonGiaDung();\n    }\n\n\n    public activeHayChonGiaDung(): void {\n        const startRotation = new Vec3(0, 0, 80); // Bắt đầu từ 80 độ\n        const endRotation = new Vec3(0, 0, -80);\n\n        this.currentTween = tween(this.icon_roll)\n            .repeatForever(\n                tween(this.icon_roll)\n                    .to(1, { eulerAngles: endRotation }, { easing: easing.smooth }) // Xoay từ 80 -> -80 trong 1 giây\n                    .to(1, { eulerAngles: startRotation }, { easing: easing.smooth })\n            )\n            .start();\n    }\n\n\n    // protected update(dt: number): void {\n\n    // }\n}\n\n/**\n * [1] Class member could be defined like this.\n * [2] Use `property` decorator if your want the member to be serializable.\n * [3] Your initialization goes here.\n * [4] Your update function goes here.\n *\n * Learn more about scripting: https://docs.cocos.com/creator/3.4/manual/en/scripting/\n * Learn more about CCClass: https://docs.cocos.com/creator/3.4/manual/en/scripting/decorator.html\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.4/manual/en/scripting/life-cycle-callbacks.html\n */\n"]}