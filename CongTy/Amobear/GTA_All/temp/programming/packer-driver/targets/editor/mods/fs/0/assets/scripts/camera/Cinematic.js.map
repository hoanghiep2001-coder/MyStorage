{"version":3,"sources":["file:///D:/CocosProjects/Amobear/GTA_All/assets/scripts/camera/Cinematic.ts"],"names":["_decorator","Component","game","log","Node","tween","Vec3","CharacterController","JoystickController","GameInfo","SoundController","ccclass","property","Cinematic","start","frameRate","tutorial3D","active","update","dt","charCtrl","isCheckpoint","isPlayCinema2","pointCtrl","joyStickCtrl","getComponent","enabled","pointCtrl2","joyStickCtrl2","playIntro","isOnMotobike","onCarButtonFlag","onCarButton","currentOption","GTA_PA_08","isHitBrakeBtn","isHitBrakeBtnFlag","subCamera2","mainCamera","tutorialUI2","tutorialUI5","scheduleOnce","playIntro2","move","to","position","tweenThen","subCamera","delay","call","rotate","eulerAngles","easing","tweenThen2","then","Instance","playSound","isRidingMoto"],"mappings":"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","sourcesContent":["import { _decorator, Component, game, log, Node, Tween, tween, Vec3, view } from 'cc';\nimport { CharacterController } from '../CharacterController';\nimport { JoystickController } from '../joystick/JoystickController';\nimport { GameInfo } from '../CONST/GameInfo';\nimport { SoundController } from '../Controller/SoundController';\nconst { ccclass, property } = _decorator;\ndeclare var window;\n\n\n@ccclass('Cinematic')\nexport class Cinematic extends Component {\n    @property(Node)\n    mainCamera: Node = null;\n    @property(Node)\n    subCamera: Node = null;\n    @property(Node)\n    subCamera2: Node = null;\n    @property(Node)\n    subCamera3: Node = null;\n    @property(Node)\n    joyStickCtrl: Node = null;\n    @property(Node)\n    pointCtrl: Node = null;\n\n\n    @property(CharacterController)\n    charCtrl: CharacterController = null;\n\n    \n    // Tutorial\n    @property(Node)\n    tutorial3D: Node = null;\n    @property(Node)\n    tutorialUI1: Node = null;\n    @property(Node)\n    tutorialUI2: Node = null;\n    @property(Node)\n    tutorialUI3: Node = null;\n    @property(Node)\n    mainChar: Node = null;\n\n    // Landscape\n    @property(Node)\n    joyStickCtrl2: Node = null;\n    @property(Node)\n    pointCtrl2: Node = null;\n\n    @property(Node)\n    tutorialUI5: Node = null;\n    @property(Node)\n    tutorialUI6: Node = null;\n\n    @property(Node)\n    landscapeUI: Node = null;\n    @property(Node)\n    portraitUI: Node = null;\n\n    @property(Node)\n    cta: Node = null;\n\n\n    private tweenThen!: Tween<Node>;\n    private tweenThen2!: Tween<Node>;\n    private tweenThen3!: Tween<Node>;\n    isPlayCinema2 = false;\n\n\n    onCarButtonFlag: boolean = false;\n\n    // onLoad() {\n    //     window.gameReady && window.gameReady();\n    // }\n\n    start() {\n        // this.scheduleOnce(this.playIntro, 1);\n        game.frameRate = 60;\n\n        this.tutorial3D.active = true;\n        // this.tutorialUI1.active = true;\n        // this.tutorialUI3.active = true;\n    }\n\n    update(dt: number) {\n        if (this.charCtrl.isCheckpoint == true && this.isPlayCinema2 == false) {\n            this.isPlayCinema2 = true;\n\n            this.pointCtrl.active = false;\n            this.joyStickCtrl.getComponent(JoystickController).enabled = false;\n            this.pointCtrl2.active = false;\n            this.joyStickCtrl2.getComponent(JoystickController).enabled = false;\n\n            this.playIntro();\n        }\n\n        // Check Device orientation\n        // var frameSize = view.getVisibleSize();\n        // if (frameSize.height > frameSize.width) {\n        //     // portrait\n        //     this.portraitUI.active = true;\n        //     this.landscapeUI.active = false;\n        // }\n        // else if (frameSize.height < frameSize.width) {\n        //     // landscape\n        //     this.portraitUI.active = false;\n        //     this.landscapeUI.active = true;\n        // }\n\n        GameInfo.isOnMotobike && !this.onCarButtonFlag && this.onCarButton();\n\n        if(GameInfo.currentOption === 8 || GameInfo.currentOption === 9)  {\n            if(GameInfo.GTA_PA_08.isHitBrakeBtn || GameInfo.GTA_PA_08.isHitBrakeBtnFlag) {\n                this.subCamera2.active = false;\n                this.mainCamera.active = true;\n            }\n        }\n\n        // if (this.cta.active == true) {\n        //     this.scheduleOnce(this.endGameSchedule, 5);\n        // }\n    }\n\n    onCarButton() {\n        this.onCarButtonFlag = true;\n\n        log(\"switch camera\");\n\n        this.tutorialUI2.active = false;\n        this.tutorialUI5.active = false;\n        this.subCamera2.active = true;\n        this.scheduleOnce(this.playIntro2, 0.2);\n    }\n\n    playIntro() {\n        log(\"play intro 1\");\n\n        let move = tween().to(1, { position: new Vec3(656.447, 28.438, -151.239) });\n\n        this.tweenThen = tween(this.subCamera)\n            .delay(0.3)\n            .call(() => {\n                this.tutorialUI2.active = true;\n                this.tutorialUI5.active = true;\n            })\n            .start();\n    }\n\n    playIntro2() {\n        log(\"play intro 2\");\n\n        let rotate = tween().to(1, { eulerAngles: new Vec3(7.1, 180, 0) }, { easing: 'smooth' });\n        let move = tween().to(0.7, { position: new Vec3(670.813, 23.697, -102.513) }, { easing: 'smooth' });\n\n        this.tweenThen2 = tween(this.subCamera2)\n            .then(move)\n            .delay(0.3)\n            .call(() => {\n                SoundController.Instance(SoundController).playSound(\"HeyYouSound\");\n                this.scheduleOnce(() => {\n                    if((GameInfo.currentOption === 8 || GameInfo.currentOption === 9)) {\n                        GameInfo.GTA_PA_08.isRidingMoto = true;\n                    }\n                    // SoundController.Instance(SoundController).playSound(\"CarBrmmSound\");\n                }, 1)\n            }) \n            .start();\n    }\n}"]}