{"version":3,"sources":["assets\\src\\snake\\SnakeBoard.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { DIRECTION, PIECE_TYPE } from './SnakeConstants';\r\nimport { Piece } from './SnakePiece';\r\nimport { SnakeScene } from './SnakeScene';\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Board extends cc.Component {\r\n    @property(cc.Float) private frameTime = 0.5;\r\n    @property(cc.Float) private levelRatio = 0.05;\r\n    @property(cc.Prefab) private piecePrefab: cc.Prefab = null;\r\n    @property(cc.Node) private layout: cc.Node = null;\r\n\r\n    public isStart = false;\r\n    private pastTime = 0;\r\n    private rowsNum: number = 16;\r\n    private colsNum: number = 16;\r\n    private gridWidth: number = 0;\r\n    private pieceMap: Piece[][];\r\n    private snake: Piece[];\r\n    private moveDir = DIRECTION.RIGHT;\r\n    public level = 0;\r\n\r\n    private snakeScene: SnakeScene = null;\r\n\r\n    onLoad() {\r\n        this.gridWidth = this.layout.width / this.colsNum;\r\n        this.pieceMap = [];\r\n        for (let x = 0; x < this.colsNum; x++) {\r\n            this.pieceMap[x] = [];\r\n            for (let y = 0; y < this.rowsNum; y++) {\r\n                let pieceNode = cc.instantiate(this.piecePrefab);\r\n                this.layout.addChild(pieceNode);\r\n                pieceNode.width = this.gridWidth;\r\n                pieceNode.height = this.gridWidth;\r\n                pieceNode.x = x * this.gridWidth + pieceNode.width / 2;\r\n                pieceNode.y = y * this.gridWidth + pieceNode.height / 2;\r\n                this.pieceMap[x][y] = pieceNode.getComponent(Piece);\r\n                this.pieceMap[x][y].x = x;\r\n                this.pieceMap[x][y].y = y;\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    updateTick() {\r\n        this.unschedule(this.tickHandler);\r\n        let time = this.frameTime - (this.levelRatio * this.level);\r\n        if (time < 0.1) {\r\n            time = 0.1;\r\n        }\r\n        this.schedule(this.tickHandler, time);\r\n    }\r\n\r\n    tickHandler() {\r\n        if (this.isStart) {\r\n            this.moveSnake();\r\n        }\r\n    }\r\n\r\n    init(snakeScene: SnakeScene) {\r\n        this.snakeScene = snakeScene;\r\n    }\r\n\r\n    startGame() {\r\n        this.reset();\r\n        for (let i = 0; i < 10; i++) {\r\n            this.addFood();\r\n        }\r\n        this.isStart = true;\r\n        this.updateTick();\r\n    }\r\n\r\n    reset() {\r\n        this.clear();\r\n        this.snake = [];\r\n        this.pieceMap[9][9].init(PIECE_TYPE.SNAKE_HEAD, DIRECTION.RIGHT, DIRECTION.RIGHT);\r\n        this.pieceMap[8][9].init(PIECE_TYPE.SNAKE_BODY, DIRECTION.RIGHT, DIRECTION.RIGHT);\r\n        this.pieceMap[7][9].init(PIECE_TYPE.SNAKE_BODY, DIRECTION.RIGHT, DIRECTION.UP);\r\n        this.pieceMap[7][8].init(PIECE_TYPE.SNAKE_TAIL, DIRECTION.UP, DIRECTION.UP);\r\n        this.snake.push(this.pieceMap[9][9]);\r\n        this.snake.push(this.pieceMap[8][9]);\r\n        this.snake.push(this.pieceMap[7][9]);\r\n        this.snake.push(this.pieceMap[7][8]);\r\n        this.moveDir = DIRECTION.RIGHT;\r\n        this.level = 0;\r\n    }\r\n\r\n    addFood() {\r\n        let blankList: Piece[] = [];\r\n        for (let x = 0; x < this.colsNum; x++) {\r\n            for (let y = 0; y < this.rowsNum; y++) {\r\n                if (this.pieceMap[x][y].type === PIECE_TYPE.BLANK) {\r\n                    blankList.push(this.pieceMap[x][y]);\r\n                }\r\n            }\r\n        }\r\n        let randomPiece = blankList[(Math.random() * blankList.length) | 0];\r\n        randomPiece.type = PIECE_TYPE.FOOD;\r\n    }\r\n\r\n    clear() {\r\n        for (let x = 0; x < this.colsNum; x++) {\r\n            for (let y = 0; y < this.rowsNum; y++) {\r\n                this.pieceMap[x][y].type = PIECE_TYPE.BLANK;\r\n            }\r\n        }\r\n    }\r\n\r\n    updateLevel(level: number) {\r\n        if (level !== this.level) {\r\n            this.level = level;\r\n            this.updateTick();\r\n        }\r\n    }\r\n\r\n    turnSnake(dir: DIRECTION) {\r\n        if (this.snake[0].outDir !== -dir) {\r\n            this.moveDir = dir;\r\n        }\r\n    }\r\n\r\n    moveSnake() {\r\n        let head = this.snake[0];\r\n        head.inDir = this.snake[1].outDir;\r\n        head.outDir = this.moveDir;\r\n        let nextPiece: Piece;\r\n        switch (head.outDir) {\r\n            case DIRECTION.UP:\r\n                if (head.y === this.rowsNum - 1) {\r\n                    nextPiece = this.pieceMap[head.x][0];\r\n                } else {\r\n                    nextPiece = this.pieceMap[head.x][head.y + 1];\r\n                }\r\n                break;\r\n            case DIRECTION.RIGHT:\r\n                if (head.x === this.colsNum - 1) {\r\n                    nextPiece = this.pieceMap[0][head.y];\r\n                } else {\r\n                    nextPiece = this.pieceMap[head.x + 1][head.y];\r\n                }\r\n                break;\r\n            case DIRECTION.DOWN:\r\n                if (head.y === 0) {\r\n                    nextPiece = this.pieceMap[head.x][this.rowsNum - 1];\r\n                } else {\r\n                    nextPiece = this.pieceMap[head.x][head.y - 1];\r\n                }\r\n                break;\r\n            case DIRECTION.LEFT:\r\n                if (head.x === 0) {\r\n                    nextPiece = this.pieceMap[this.colsNum - 1][head.y];\r\n                } else {\r\n                    nextPiece = this.pieceMap[head.x - 1][head.y];\r\n                }\r\n                break;\r\n        }\r\n        this.moveSnakeToPiece(nextPiece);\r\n    }\r\n\r\n    moveSnakeToPiece(nextPiece: Piece) {\r\n        let head = this.snake[0];\r\n        switch (nextPiece.type) {\r\n            case PIECE_TYPE.SNAKE_BODY:\r\n            case PIECE_TYPE.SNAKE_TAIL:\r\n                this.isStart = false;\r\n                this.snakeScene.overGame();\r\n                break;\r\n            case PIECE_TYPE.FOOD:\r\n                nextPiece.init(PIECE_TYPE.SNAKE_HEAD, head.outDir, head.inDir);\r\n                head.init(PIECE_TYPE.SNAKE_BODY, head.outDir, head.inDir);\r\n                this.snake.unshift(nextPiece);\r\n                this.snakeScene.onEatFood();\r\n                break;\r\n            case PIECE_TYPE.BLANK:\r\n                let newSnake = [];\r\n                this.snake.forEach((piece, index) => {\r\n                    switch (piece.type) {\r\n                        case PIECE_TYPE.SNAKE_HEAD:\r\n                            nextPiece.init(PIECE_TYPE.SNAKE_HEAD, piece.outDir, piece.inDir);\r\n                            break;\r\n                        case PIECE_TYPE.SNAKE_BODY:\r\n                            nextPiece.init(PIECE_TYPE.SNAKE_BODY, nextPiece.outDir, piece.outDir);\r\n                            break;\r\n                        case PIECE_TYPE.SNAKE_TAIL:\r\n                            nextPiece.init(PIECE_TYPE.SNAKE_TAIL, nextPiece.outDir, piece.outDir);\r\n                            piece.type = PIECE_TYPE.BLANK;\r\n                            break;\r\n                    }\r\n                    newSnake.push(nextPiece);\r\n                    nextPiece = piece;\r\n                });\r\n                // for (let piece of this.snake) {\r\n\r\n                // }\r\n                this.snake = newSnake;\r\n        }\r\n    }\r\n\r\n    // update(dt: number) {\r\n    //     if (this.isStart) {\r\n    //         this.pastTime += dt;\r\n    //         if (this.pastTime >= this.frameTime * (this.levelRatio**this.level)) {\r\n    //             this.moveSnake();\r\n    //             this.pastTime = 0;\r\n    //         }\r\n    //     }\r\n    // }\r\n}\r\n"]}