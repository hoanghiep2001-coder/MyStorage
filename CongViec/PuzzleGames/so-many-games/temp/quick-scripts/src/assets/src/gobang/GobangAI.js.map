{"version":3,"sources":["assets\\src\\gobang\\GobangAI.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { GobangBoard } from \"./GobangBoard\";\r\nimport { NONE, BLACK, WHITE } from \"./GobangConstants\";\r\n\r\nexport class GobangAI {\r\n\r\n    private fiveGroup:Array<Array<cc.Vec2>> = [];//五元组\r\n\r\n    private fiveGroupScore:Array<number> = []//五元组分数\r\n\r\n    constructor(private board: GobangBoard) { \r\n        //添加五元数组\r\n        //横向\r\n        for(let y=0;y<15;y++){\r\n            for(let x=0;x<11;x++){\r\n                this.fiveGroup.push([cc.v2(x,y),cc.v2(x+1,y),cc.v2(x+2,y),cc.v2(x+3,y),cc.v2(x+4,y)]);\r\n            }  \r\n        }\r\n        //纵向\r\n        for(let x=0;x<15;x++){\r\n            for(let y=0;y<11;y++){\r\n                this.fiveGroup.push([cc.v2(x,y),cc.v2(x,y+1),cc.v2(x,y+2),cc.v2(x,y+3),cc.v2(x,y+4)]);\r\n            }\r\n        }\r\n        //右上斜向\r\n        for(let b=-10;b<=10;b++){\r\n            for(let x=0;x<11;x++){\r\n                if(b+x<0||b+x>10){\r\n                    continue;\r\n                }else{\r\n                    this.fiveGroup.push([cc.v2(x,b+x),cc.v2(x+1,b+x+1),cc.v2(x+2,b+x+2),cc.v2(x+3,b+x+3),cc.v2(x+4,b+x+4)]);\r\n                }\r\n            }\r\n        }\r\n        //右下斜向\r\n        for(let b=4;b<=24;b++){\r\n            for(let y=0;y<11;y++){\r\n                if(b-y<4||b-y>14){\r\n                    continue;\r\n                }else{\r\n                    this.fiveGroup.push([cc.v2(b-y,y),cc.v2(b-y-1,y+1),cc.v2(b-y-2,y+2),cc.v2(b-y-3,y+3),cc.v2(b-y-4,y+4)]);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    getNextCoor():cc.Vec2 {\r\n        let pieceMap = this.board.pieceMap;        \r\n        //评分\r\n        for (let i = 0; i < this.fiveGroup.length; i++) {\r\n            let b = 0;//五元组里黑棋的个数\r\n            let w = 0;//五元组里白棋的个数\r\n            for (let j = 0; j < 5; j++) {\r\n                if (this.board.getPieceByCoor(this.fiveGroup[i][j]).color === BLACK) {\r\n                    b++;\r\n                } else if (this.board.getPieceByCoor(this.fiveGroup[i][j]).color === WHITE) {\r\n                    w++;\r\n                }\r\n            }\r\n            if (b + w == 0) {\r\n                this.fiveGroupScore[i] = 7;\r\n            } else if (b > 0 && w > 0) {\r\n                this.fiveGroupScore[i] = 0;\r\n            } else if (b == 0 && w == 1) {\r\n                this.fiveGroupScore[i] = 35;\r\n            } else if (b == 0 && w == 2) {\r\n                this.fiveGroupScore[i] = 800;\r\n            } else if (b == 0 && w == 3) {\r\n                this.fiveGroupScore[i] = 15000;\r\n            } else if (b == 0 && w == 4) {\r\n                this.fiveGroupScore[i] = 800000;\r\n            } else if (w == 0 && b == 1) {\r\n                this.fiveGroupScore[i] = 15;\r\n            } else if (w == 0 && b == 2) {\r\n                this.fiveGroupScore[i] = 400;\r\n            } else if (w == 0 && b == 3) {\r\n                this.fiveGroupScore[i] = 1800;\r\n            } else if (w == 0 && b == 4) {\r\n                this.fiveGroupScore[i] = 100000;\r\n            }\r\n        }\r\n        //找最高分的五元组\r\n        let hScore = 0;\r\n        let mPosition = 0;\r\n        for (let i = 0; i < this.fiveGroupScore.length; i++) {\r\n            if (this.fiveGroupScore[i] > hScore) {\r\n                hScore = this.fiveGroupScore[i];\r\n                mPosition = i;\r\n            }\r\n        }\r\n        //在最高分的五元组里找到最优下子位置\r\n        let flag1 = false;//无子\r\n        let flag2 = false;//有子\r\n        let nPosition = 0;\r\n        for (let i = 0; i < 5; i++) {\r\n            if (!flag1 && this.board.getPieceByCoor(this.fiveGroup[mPosition][i]).color === NONE) {\r\n                nPosition = i;\r\n            }\r\n            if (!flag2 && this.board.getPieceByCoor(this.fiveGroup[mPosition][i]).color !== NONE) {\r\n                flag1 = true;\r\n                flag2 = true;\r\n            }\r\n            if (flag2 && this.board.getPieceByCoor(this.fiveGroup[mPosition][i]).color === NONE) {\r\n                nPosition = i;\r\n                break;\r\n            }\r\n        }\r\n        //在最最优位置下子\r\n        return this.fiveGroup[mPosition][nPosition];\r\n    }\r\n}"]}