{"version":3,"sources":["assets\\src\\mine\\MineScene.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { Piece } from \"./MinePiece\";\r\nimport { Board } from \"./MnieBoard\";\r\nimport { G } from \"../G\";\r\nimport { STATE } from \"./MineConstans\";\r\nimport { MineLevelLabel } from \"./MineLevelLabel\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport class MineScene extends cc.Component {\r\n\r\n    @property(Board)\r\n    private board: Board = null;\r\n    @property(cc.Label)\r\n    private bombNumLabel: cc.Label = null;\r\n    @property(cc.Label)\r\n    private flagNumLabel: cc.Label = null;\r\n    @property(MineLevelLabel)\r\n    private levelLabel: MineLevelLabel = null;\r\n\r\n    private state: STATE = STATE.NONE;\r\n    private level: number = 1;\r\n    private maxLevel: number = 20;\r\n\r\n    start() {\r\n        this.board.init(this);\r\n        this.maxLevel = this.board.getMaxLevel();\r\n        this.startGame(1);\r\n    }\r\n\r\n    startGame(level: number) {\r\n        this.level = level;\r\n        this.state = STATE.START;\r\n        this.board.reset(level);\r\n        this.levelLabel.level = level;\r\n        this.bombNumLabel.string = this.board.getBombNum() + \"\";\r\n        this.flagNumLabel.string = this.board.getFlagNum() + \"\";\r\n    }\r\n\r\n    overGame(isWin: boolean) {\r\n        this.state = STATE.OVER;\r\n        if (isWin) {\r\n            if (this.level === this.maxLevel) {\r\n                G.gameRoot.showMaskMessage(\"恭喜通关!\\n获得雷公称号!\",\r\n                    { label: \"233\", cb: () => { G.returnHall() }, target: this }\r\n                );\r\n            } else {\r\n                G.gameRoot.showMaskMessage(\"恭喜通过第\" + this.level + \"关!\",\r\n                    {\r\n                        label: \"下一关\", cb: () => {\r\n                            this.level++;\r\n                            this.startGame(this.level);\r\n                        }, target: this\r\n                    },\r\n                    { label: \"不玩了\", cb: () => { G.returnHall() }, target: this }\r\n                );\r\n            }\r\n        } else {\r\n            G.gameRoot.showMaskMessage(\"你死在了第\" + this.level + \"关!\",\r\n                {\r\n                    label: \"续命\", cb: () => {\r\n                        this.startGame(this.level);\r\n                    }, target: this\r\n                },\r\n                { label: \"不玩了\", cb: () => { G.returnHall() }, target: this }\r\n            );\r\n        }\r\n    }\r\n\r\n    onClickPiece(piece: Piece) {\r\n        if (this.state === STATE.START) {\r\n            this.board.openPiece(piece);\r\n            let bombNum = this.board.getBombNum();\r\n            this.bombNumLabel.string = bombNum + \"\";\r\n        }\r\n    }\r\n\r\n    onPressPiece(piece: Piece) {\r\n        if (this.state === STATE.START) {\r\n            this.board.flagPiece(piece);\r\n            let flagNum = this.board.getFlagNum();\r\n            this.flagNumLabel.string = flagNum + \"\";\r\n        }\r\n    }\r\n\r\n    onBtnReturn() {\r\n        G.returnHall();\r\n    }\r\n\r\n    onBtnRestart() {\r\n        this.startGame(this.level);\r\n    }\r\n}"]}