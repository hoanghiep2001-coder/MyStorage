{"version":3,"sources":["assets\\src\\get47\\Get47Board.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { Get47Scene } from \"./Get47Scene\";\r\nimport { Piece } from \"./Get47Piece\";\r\nimport { DIR } from \"./Get47Constants\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport class Get47Board extends cc.Component {\r\n\r\n    @property(cc.Integer)\r\n    private colsNum: number = 7;\r\n    @property(cc.Integer)\r\n    private rowsNum: number = 7;\r\n    @property(cc.Integer)\r\n    private padding: number = 5;\r\n    @property(cc.Integer)\r\n    private spacing: number = 5;\r\n    @property(cc.Prefab)\r\n    private piecePrefab: cc.Prefab = null;\r\n\r\n    private pieceWidth: number;\r\n    private get47Scene: Get47Scene = null;\r\n    private pieceMap: Array<Array<Piece>>;\r\n    private runningAction: boolean = false;\r\n    private score: number = 0;\r\n\r\n    private inputDir: number = 0; // 手机倾斜方向，1向右分数相加，-1向左分数相减\r\n\r\n    public init(get47Scene: Get47Scene) {\r\n        this.get47Scene = get47Scene;\r\n        this.pieceWidth = (this.node.width - this.padding * 2 - this.spacing * (this.colsNum - 1)) / this.colsNum;\r\n    }\r\n\r\n    public reset() {\r\n        this.node.removeAllChildren();\r\n        this.pieceMap = [];\r\n        for (let x = 0; x < this.colsNum; x++) {\r\n            this.pieceMap[x] = [];\r\n            for (let y = 0; y < this.rowsNum; y++) {\r\n                let pieceNode = cc.instantiate(this.piecePrefab);\r\n                this.node.addChild(pieceNode);\r\n                pieceNode.width = this.pieceWidth;\r\n                pieceNode.height = this.pieceWidth;\r\n                pieceNode.position = cc.v2(this.padding + x * (this.pieceWidth + this.spacing),\r\n                    this.padding + y * (this.pieceWidth + this.spacing));\r\n                let piece = pieceNode.getComponent(Piece);\r\n                piece.init(x, y);\r\n                this.addTouchEvent(piece);\r\n                this.pieceMap[x][y] = piece;\r\n            }\r\n        }\r\n        this.deletePieces();\r\n    }\r\n\r\n    private addTouchEvent(piece: Piece) {\r\n        let f = (e: cc.Event.EventTouch) => {\r\n            if (this.runningAction) {\r\n                return;\r\n            }\r\n            let p1 = e.getStartLocation();\r\n            let p2 = e.getLocation();\r\n            let dir: DIR;\r\n            if (Math.abs(p2.x - p1.x) > Math.abs(p2.y - p1.y)) {\r\n                if (p2.x > p1.x) {\r\n                    dir = DIR.RIGHT;\r\n                } else {\r\n                    dir = DIR.LEFT;\r\n                }\r\n            } else {\r\n                if (p2.y > p1.y) {\r\n                    dir = DIR.UP;\r\n                } else {\r\n                    dir = DIR.DOWN;\r\n                }\r\n            }\r\n            this.inputDir = 0;\r\n            this.get47Scene.onPieceTouch(piece, dir);\r\n        };\r\n        piece.node.on(cc.Node.EventType.TOUCH_END, f, this);\r\n        piece.node.on(cc.Node.EventType.TOUCH_CANCEL, f, this);\r\n\r\n    }\r\n\r\n    public tryExchange(piece: Piece, dir: DIR) {\r\n        let neighborPiece = this.getNeighborPiece(piece, dir);\r\n        if (neighborPiece === null) {\r\n            return;\r\n        }\r\n        this.runningAction = true;\r\n\r\n        this.exchangeTwoPiecesState(piece, neighborPiece);\r\n        let hLines = this.getHorizontalLines();\r\n        let vLines = this.getVerticalLines();\r\n        if (hLines.length + vLines.length > 0) {\r\n            this.exchangeTwoPiecesPosIndex(piece, neighborPiece);\r\n            let finished = 0;\r\n            let total = 2;\r\n            let self = this;\r\n            let action1 = cc.sequence(cc.moveTo(0.15, piece.posIndex),\r\n                cc.callFunc(() => {\r\n                    finished++;\r\n                    if (finished === total) {\r\n                        this.runningAction = false;\r\n                        this.deletePieces();\r\n                    }\r\n                })\r\n            );\r\n            let action2 = cc.sequence(cc.moveTo(0.15, neighborPiece.posIndex),\r\n                cc.callFunc(() => {\r\n                    finished++;\r\n                    if (finished === total) {\r\n                        this.runningAction = false;\r\n                        this.deletePieces();\r\n                    }\r\n                })\r\n            );\r\n            piece.node.runAction(action1);\r\n            neighborPiece.node.runAction(action2);\r\n        } else {\r\n            this.exchangeTwoPiecesState(piece, neighborPiece);\r\n            let finished = 0;\r\n            let total = 2;\r\n            let tilePos = piece.node.position;\r\n            let neighborTilePos = neighborPiece.node.position;\r\n            let action1 = cc.sequence(cc.moveTo(0.1, neighborTilePos), cc.moveTo(0.1, tilePos),\r\n                cc.callFunc(() => {\r\n                    finished++;\r\n                    if (finished === total) {\r\n                        this.runningAction = false;\r\n                    }\r\n                })\r\n            );\r\n            let action2 = cc.sequence(cc.moveTo(0.1, tilePos), cc.moveTo(0.1, neighborTilePos),\r\n                cc.callFunc(() => {\r\n                    finished++;\r\n                    if (finished === total) {\r\n                        this.runningAction = false;\r\n                    }\r\n                })\r\n            );\r\n            piece.node.runAction(action1);\r\n            neighborPiece.node.runAction(action2);\r\n        }\r\n\r\n    }\r\n\r\n    private exchangeTwoPiecesState(piece1: Piece, piece2: Piece) {\r\n        this.pieceMap[piece1.x][piece1.y] = piece2;\r\n        this.pieceMap[piece2.x][piece2.y] = piece1;\r\n        [piece1.x, piece2.x] = [piece2.x, piece1.x];\r\n        [piece1.y, piece2.y] = [piece2.y, piece1.y];\r\n    }\r\n\r\n    private exchangeTwoPiecesPosIndex(piece1: Piece, piece2: Piece) {//交换位置信息，实际位置没有改变\r\n        [piece1.posIndex, piece2.posIndex] = [piece2.posIndex, piece1.posIndex]\r\n    }\r\n\r\n    private deletePieces() {\r\n        this.runningAction = true;\r\n        let hLines = this.getHorizontalLines();\r\n        let vLines = this.getVerticalLines();\r\n        if (hLines.length + vLines.length === 0) {\r\n            this.runningAction = false;\r\n            return;\r\n        }\r\n        let addNumber = 0;//横加竖减\r\n        let minusNumber = 0;\r\n        let lines: Array<Piece> = [];\r\n        for (let piece of hLines) {\r\n            addNumber += piece.type;\r\n            lines.push(piece);\r\n        }\r\n        for (let vPiece of vLines) {\r\n            minusNumber += vPiece.type;\r\n            if (lines.indexOf(vPiece) === -1) {\r\n                lines.push(vPiece);\r\n            }\r\n        }\r\n        // TODO:\r\n        if (this.inputDir > 0) {\r\n            this.get47Scene.updateScore(addNumber + minusNumber);\r\n        } else if (this.inputDir < 0) {\r\n            this.get47Scene.updateScore(-addNumber - minusNumber);\r\n        } else {\r\n            this.get47Scene.updateScore(addNumber - minusNumber);\r\n        }\r\n        // this.score += (addNumber - minusNumber);\r\n\r\n        let finished = 0;\r\n        let total = lines.length;\r\n        for (let i = 0; i < total; i++) {\r\n            let action = cc.sequence(cc.scaleTo(0.15, 0, 0),\r\n                cc.callFunc(() => {\r\n                    finished++;\r\n                    if (finished === total) {\r\n                        this.runningAction = false;\r\n                        this.fallPieces();\r\n                    }\r\n                })\r\n            );\r\n            lines[i].isAlive = false;\r\n            lines[i].node.runAction(action);\r\n        }\r\n    }\r\n\r\n    private fallPieces() {\r\n        this.runningAction = true;\r\n        //下落\r\n        let isAllFall = false;\r\n        while (!isAllFall) {\r\n            isAllFall = true;\r\n            for (let y = 1; y < this.rowsNum; y++) {\r\n                for (let x = 0; x < this.colsNum; x++) {\r\n                    if (this.pieceMap[x][y].isAlive && !this.pieceMap[x][y - 1].isAlive) {\r\n                        this.exchangeTwoPiecesState(this.pieceMap[x][y], this.pieceMap[x][y - 1]);\r\n                        this.exchangeTwoPiecesPosIndex(this.pieceMap[x][y], this.pieceMap[x][y - 1]);\r\n                        isAllFall = false;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        let fallingPieces: Array<Piece> = [];\r\n        for (let x = 0; x < this.colsNum; x++) {\r\n            for (let y = 0; y < this.rowsNum; y++) {\r\n                if (this.pieceMap[x][y].posIndex !== this.pieceMap[x][y].node.position) {\r\n                    fallingPieces.push(this.pieceMap[x][y]);\r\n                }\r\n            }\r\n        }\r\n\r\n        let finished = 0;\r\n        let total = fallingPieces.length;\r\n        for (let i = 0; i < total; i++) {\r\n            let action = cc.sequence(cc.moveTo(0.3, fallingPieces[i].posIndex),\r\n                cc.callFunc(() => {\r\n                    finished++;\r\n                    if (finished == total) {\r\n                        this.runningAction = false;\r\n                        this.addPieces();\r\n                    }\r\n                })\r\n            );\r\n            fallingPieces[i].node.runAction(action);\r\n        }\r\n\r\n    }\r\n\r\n    private addPieces() {\r\n        this.runningAction = true;\r\n        //填补空白\r\n        let addingPieces: Array<Piece> = [];\r\n        for (let y = 0; y < this.rowsNum; y++) {\r\n            for (let x = 0; x < this.colsNum; x++) {\r\n                if (!this.pieceMap[x][y].isAlive) {\r\n                    addingPieces.push(this.pieceMap[x][y]);\r\n                }\r\n            }\r\n        }\r\n\r\n        let finished = 0;\r\n        let total = addingPieces.length;\r\n        for (let i = 0; i < total; i++) {\r\n            let action = cc.sequence(cc.scaleTo(0.15, 1, 1),\r\n                cc.callFunc(() => {\r\n                    finished++;\r\n                    if (finished == total) {\r\n                        this.runningAction = false;\r\n                        this.deletePieces();\r\n                    }\r\n                })\r\n            );\r\n            addingPieces[i].randomType();\r\n            addingPieces[i].isAlive = true;\r\n            addingPieces[i].node.runAction(action);\r\n        }\r\n    }\r\n\r\n    private getVerticalLines(): Array<Piece> {\r\n        let linePieces: Array<Piece> = [];\r\n        let count = 1;\r\n        for (let x = 0; x < this.colsNum; x++) {\r\n            for (let y = 0; y < this.rowsNum - 2; y = y + count) {\r\n                let piece = this.pieceMap[x][y];\r\n                count = 1;\r\n                for (let n = y + 1; n < this.rowsNum; n++) {\r\n                    if (this.pieceMap[x][n].type === piece.type) {\r\n                        count++;\r\n                    } else {\r\n                        break;\r\n                    }\r\n                }\r\n                if (count >= 3) {\r\n                    for (let i = 0; i < count; i++) {\r\n                        linePieces.push(this.pieceMap[x][y + i]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return linePieces;\r\n    }\r\n\r\n    private getHorizontalLines(): Array<Piece> {\r\n        let linePieces: Array<Piece> = [];\r\n        let count = 1;\r\n        for (let y = 0; y < this.rowsNum; y++) {\r\n            for (let x = 0; x < this.colsNum - 2; x = x + count) {\r\n                let piece = this.pieceMap[x][y];\r\n                let pieceType = piece.type;\r\n                count = 1;\r\n                for (let n = x + 1; n < this.colsNum; n++) {\r\n                    if (this.pieceMap[n][y].type === pieceType) {\r\n                        count++;\r\n                    } else {\r\n                        break;\r\n                    }\r\n                }\r\n                if (count >= 3) {\r\n                    for (let i = 0; i < count; i++) {\r\n                        linePieces.push(this.pieceMap[x + i][y]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return linePieces;\r\n    }\r\n\r\n    private getNeighborPiece(piece: Piece, dir: DIR): Piece {\r\n        let x = piece.x;\r\n        let y = piece.y;\r\n        switch (dir) {\r\n            case DIR.LEFT:\r\n                if (x > 0) {\r\n                    return this.pieceMap[x - 1][y];\r\n                }\r\n                break;\r\n            case DIR.RIGHT:\r\n                if (x < this.colsNum - 1) {\r\n                    return this.pieceMap[x + 1][y];\r\n                }\r\n                break;\r\n            case DIR.UP:\r\n                if (y < this.rowsNum - 1) {\r\n                    return this.pieceMap[x][y + 1];\r\n                }\r\n                break;\r\n            case DIR.DOWN:\r\n                if (y > 0) {\r\n                    return this.pieceMap[x][y - 1];\r\n                }\r\n                break;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    public newView(input: number = 0) {\r\n        this.inputDir = input;\r\n        if (!this.runningAction) {\r\n            this.runningAction = true;\r\n            let finished = 0;\r\n            for (let x = 0; x < this.colsNum; x++) {\r\n                for (let y = 0; y < this.rowsNum; y++) {\r\n                    let action = cc.sequence(cc.scaleTo(0.3, 0, 0),\r\n                        cc.callFunc(() => {\r\n                            finished++;\r\n                            if (finished === (this.colsNum - 1) * (this.rowsNum - 1)) {\r\n                                this.runningAction = false;\r\n                                this.addPieces();\r\n                            }\r\n                        })\r\n                    );\r\n                    this.pieceMap[x][y].isAlive = false;\r\n                    this.pieceMap[x][y].node.runAction(action);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}"]}