{"version":3,"sources":["assets\\src\\get47\\Get47Scene.ts"],"names":[],"mappings":";;;;;;AAAA,2CAA0C;AAE1C,mDAA8C;AAC9C,0BAAyB;AACzB,2CAAqC;AAE/B,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAAgC,8BAAY;IAA5C;QAAA,qEA+EC;QA5EW,WAAK,GAAe,IAAI,CAAC;QAEzB,WAAK,GAAU,IAAI,CAAC;QAEpB,YAAM,GAAW,EAAE,CAAC;QAEpB,WAAK,GAAU,sBAAK,CAAC,IAAI,CAAC;;IAsEtC,CAAC;IApEG,0BAAK,GAAL;QACI,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACtB,IAAI,CAAC,SAAS,EAAE,CAAC;QACjB,IAAI,CAAC,YAAY,EAAE,CAAC;IACxB,CAAC;IAEO,8BAAS,GAAjB;QACI,IAAI,CAAC,KAAK,GAAG,sBAAK,CAAC,KAAK,CAAC;QACzB,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC;QACnB,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IACxB,CAAC;IAEO,6BAAQ,GAAhB;QACI,IAAI,CAAC,KAAK,GAAG,sBAAK,CAAC,IAAI,CAAC;QACxB,KAAC,CAAC,QAAQ,CAAC,eAAe,CAAC,KAAK,EAC5B,EAAE,KAAK,EAAE,KAAK,EAAE,EAAE,EAAE,cAAQ,CAAC,EAAE,MAAM,EAAE,IAAI,EAAE,CAAC,CAAC;IACvD,CAAC;IAEM,gCAAW,GAAlB,UAAmB,KAAa;QAC5B,IAAI,IAAI,CAAC,KAAK,KAAK,sBAAK,CAAC,KAAK,EAAE;YAC5B,OAAO;SACV;QACD,IAAI,KAAK,GAAG,CAAC,EAAE;YACX,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;SACzB;aAAM,IAAI,KAAK,GAAG,CAAC,EAAE;YAClB,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,CAAC;SAC5B;QACD,IAAI,IAAI,CAAC,KAAK,CAAC,GAAG,KAAK,IAAI,CAAC,MAAM,EAAE;YAChC,IAAI,CAAC,QAAQ,EAAE,CAAC;SACnB;IACL,CAAC;IAEM,iCAAY,GAAnB,UAAoB,KAAY,EAAE,GAAQ;QACtC,IAAI,IAAI,CAAC,KAAK,KAAK,sBAAK,CAAC,KAAK,EAAE;YAC5B,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;SACtC;IACL,CAAC;IAEO,gCAAW,GAAnB;QACI,KAAC,CAAC,UAAU,EAAE,CAAC;IACnB,CAAC;IAEO,iCAAY,GAApB;QACI,IAAI,CAAC,SAAS,EAAE,CAAC;IACrB,CAAC;IAEO,iCAAY,GAApB;QACI,0DAA0D;QAC1D,4FAA4F;IAChG,CAAC;IAEO,oCAAe,GAAvB;QACK,EAAU,CAAC,YAAY,CAAC,uBAAuB,CAAC,KAAK,CAAC,CAAC;IAC5D,CAAC;IAEO,wCAAmB,GAA3B,UAA4B,KAAK;QAC7B,oEAAoE;QACpE,4BAA4B;QAC5B,IAAI;QACJ,UAAU;QACV,yBAAyB;QACzB,6BAA6B;QAC7B,IAAI;QACJ,2BAA2B;QAC3B,8BAA8B;QAC9B,IAAI;IACR,CAAC;IA1ED;QADC,QAAQ,CAAC,uBAAU,CAAC;6CACY;IAEjC;QADC,QAAQ,CAAC,kBAAK,CAAC;6CACY;IAE5B;QADC,QAAQ,CAAC,EAAE,CAAC,OAAO,CAAC;8CACO;IAPnB,UAAU;QADtB,OAAO;OACK,UAAU,CA+EtB;IAAD,iBAAC;CA/ED,AA+EC,CA/E+B,EAAE,CAAC,SAAS,GA+E3C;AA/EY,gCAAU","file":"","sourceRoot":"/","sourcesContent":["import { Get47Board } from \"./Get47Board\";\r\nimport { Piece } from \"./Get47Piece\";\r\nimport { DIR, STATE } from \"./Get47Constants\";\r\nimport { G } from \"../G\";\r\nimport { Score } from \"./Get47Score\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport class Get47Scene extends cc.Component {\r\n\r\n    @property(Get47Board)\r\n    private board: Get47Board = null;\r\n    @property(Score)\r\n    private score: Score = null;\r\n    @property(cc.Integer)\r\n    private target: number = 47;\r\n\r\n    private state: STATE = STATE.NONE;\r\n\r\n    start() {\r\n        this.board.init(this);\r\n        this.startGame();\r\n        this.addListeners();\r\n    }\r\n\r\n    private startGame() {\r\n        this.state = STATE.START;\r\n        this.board.reset();\r\n        this.score.reset(0);\r\n    }\r\n\r\n    private overGame() {\r\n        this.state = STATE.OVER;\r\n        G.gameRoot.showMaskMessage(\"666\",\r\n            { label: \"233\", cb: () => { }, target: this });\r\n    }\r\n\r\n    public updateScore(score: number) {\r\n        if (this.state !== STATE.START) {\r\n            return;\r\n        }\r\n        if (score > 0) {\r\n            this.score.add(score);\r\n        } else if (score < 0) {\r\n            this.score.minus(-score);\r\n        }\r\n        if (this.score.num === this.target) {\r\n            this.overGame();\r\n        }\r\n    }\r\n\r\n    public onPieceTouch(piece: Piece, dir: DIR) {\r\n        if (this.state === STATE.START) {\r\n            this.board.tryExchange(piece, dir);\r\n        }\r\n    }\r\n\r\n    private onBtnReturn() {\r\n        G.returnHall();\r\n    }\r\n\r\n    private onBtnRestart() {\r\n        this.startGame();\r\n    }\r\n\r\n    private addListeners() {\r\n        // (cc as any).inputManager.setAccelerometerEnabled(true);\r\n        // cc.systemEvent.on(cc.SystemEvent.EventType.DEVICEMOTION, this.onDeviceMotionEvent, this);\r\n    }\r\n\r\n    private removeListeners() {\r\n        (cc as any).inputManager.setAccelerometerEnabled(false);\r\n    }\r\n\r\n    private onDeviceMotionEvent(event) {\r\n        // if (Math.abs(event.acc.x) > 0.3 && Math.abs(event.acc.y) > 0.3) {\r\n        //     this.board.newView();\r\n        // }\r\n        // 一个失败的创意\r\n        // if(event.acc.x > 0.5){\r\n        //     this.board.newView(1);\r\n        // }\r\n        // if(event.acc.x < -0.5) {\r\n        //     this.board.newView(-1);\r\n        // }\r\n    }\r\n\r\n}\r\n"]}